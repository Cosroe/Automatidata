%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}




\title{Automatidata Project}
\date{Jul 10, 2024}
\release{}
\author{Kasra Hashemi}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\tableofcontents
\newpage
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
As a junior data analyst at the fictional data consulting company Automatidata, I was given a project to analyze a dataset from the New York City Taxi and Limousine Commission project (New York City TLC). The aim of this project was to help NYC TLC make data\sphinxhyphen{}driven decisions to improve their operations.

\sphinxstepscope


\chapter{EDA}
\label{\detokenize{Automatidata_EDA:eda}}\label{\detokenize{Automatidata_EDA::doc}}
\sphinxAtStartPar
You are the newest data professional in a fictional data consulting firm: Automatidata. The team is still early into the project, having only just completed an initial plan of action and some early Python coding work.

\sphinxAtStartPar
Luana Rodriquez, the senior data analyst at Automatidata, is pleased with the work you have already completed and requests your assistance with some EDA and data visualization work for the New York City Taxi and Limousine Commission project (New York City TLC) to get a general understanding of what taxi ridership looks like. The management team is asking for a Python notebook showing data structuring and cleaning, as well as any matplotlib/seaborn visualizations plotted to help understand the data. At the very least, include a box plot of the ride durations and some time series plots, like a breakdown by quarter or month.

\sphinxAtStartPar
Additionally, the management team has recently asked all EDA to include Tableau visualizations. For this taxi data, create a Tableau dashboard showing a New York City map of taxi/limo trips by month. Make sure it is easy to understand to someone who isn’t data savvy, and remember that the assistant director at the New York City TLC is a person with visual impairments.

\sphinxAtStartPar
A notebook was structured and prepared to help you in this project. Please complete the following questions.


\bigskip\hrule\bigskip



\section{First steps to examine the structure of the dataset}
\label{\detokenize{Automatidata_EDA:first-steps-to-examine-the-structure-of-the-dataset}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Import packages and libraries}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{seaborn} \PYG{k}{as} \PYG{n+nn}{sns}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Load dataset into dataframe}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2017\PYGZus{}Yellow\PYGZus{}Taxi\PYGZus{}Trip\PYGZus{}Data.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID    tpep\PYGZus{}pickup\PYGZus{}datetime   tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2   03/25/2017 8:55:43 AM   03/25/2017 9:09:47 AM   
1    35634249         1   04/11/2017 2:53:28 PM   04/11/2017 3:19:58 PM   
2   106203690         1   12/15/2017 7:26:56 AM   12/15/2017 7:34:08 AM   
3    38942136         2   05/07/2017 1:17:59 PM   05/07/2017 1:48:14 PM   
4    30841670         2  04/15/2017 11:32:20 PM  04/15/2017 11:49:03 PM   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   
1                1           1.80           1                  N   
2                1           1.00           1                  N   
3                1           3.70           1                  N   
4                1           4.37           1                  N   

   PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0           100           231             1         13.0    0.0      0.5   
1           186            43             1         16.0    0.0      0.5   
2           262           236             1          6.5    0.0      0.5   
3           188            97             1         20.5    0.0      0.5   
4             4           112             2         16.5    0.5      0.5   

   tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  
0        2.76           0.0                    0.3         16.56  
1        4.00           0.0                    0.3         20.80  
2        1.45           0.0                    0.3          8.75  
3        6.39           0.0                    0.3         27.69  
4        0.00           0.0                    0.3         17.80  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
408582

(22699, 18)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         Unnamed: 0      VendorID  passenger\PYGZus{}count  trip\PYGZus{}distance  \PYGZbs{}
count  2.269900e+04  22699.000000     22699.000000   22699.000000   
mean   5.675849e+07      1.556236         1.642319       2.913313   
std    3.274493e+07      0.496838         1.285231       3.653171   
min    1.212700e+04      1.000000         0.000000       0.000000   
25\PYGZpc{}    2.852056e+07      1.000000         1.000000       0.990000   
50\PYGZpc{}    5.673150e+07      2.000000         1.000000       1.610000   
75\PYGZpc{}    8.537452e+07      2.000000         2.000000       3.060000   
max    1.134863e+08      2.000000         6.000000      33.960000   

         RatecodeID  PULocationID  DOLocationID  payment\PYGZus{}type   fare\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000  22699.000000   
mean       1.043394    162.412353    161.527997      1.336887     13.026629   
std        0.708391     66.633373     70.139691      0.496211     13.243791   
min        1.000000      1.000000      1.000000      1.000000   \PYGZhy{}120.000000   
25\PYGZpc{}        1.000000    114.000000    112.000000      1.000000      6.500000   
50\PYGZpc{}        1.000000    162.000000    162.000000      1.000000      9.500000   
75\PYGZpc{}        1.000000    233.000000    233.000000      2.000000     14.500000   
max       99.000000    265.000000    265.000000      4.000000    999.990000   

              extra       mta\PYGZus{}tax    tip\PYGZus{}amount  tolls\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000   
mean       0.333275      0.497445      1.835781      0.312542   
std        0.463097      0.039465      2.800626      1.399212   
min       \PYGZhy{}1.000000     \PYGZhy{}0.500000      0.000000      0.000000   
25\PYGZpc{}        0.000000      0.500000      0.000000      0.000000   
50\PYGZpc{}        0.000000      0.500000      1.350000      0.000000   
75\PYGZpc{}        0.500000      0.500000      2.450000      0.000000   
max        4.500000      0.500000    200.000000     19.100000   

       improvement\PYGZus{}surcharge  total\PYGZus{}amount  
count           22699.000000  22699.000000  
mean                0.299551     16.310502  
std                 0.015673     16.097295  
min                \PYGZhy{}0.300000   \PYGZhy{}120.300000  
25\PYGZpc{}                 0.300000      8.750000  
50\PYGZpc{}                 0.300000     11.800000  
75\PYGZpc{}                 0.300000     17.800000  
max                 0.300000   1200.290000  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 18 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   Unnamed: 0             22699 non\PYGZhy{}null  int64  
 1   VendorID               22699 non\PYGZhy{}null  int64  
 2   tpep\PYGZus{}pickup\PYGZus{}datetime   22699 non\PYGZhy{}null  object 
 3   tpep\PYGZus{}dropoff\PYGZus{}datetime  22699 non\PYGZhy{}null  object 
 4   passenger\PYGZus{}count        22699 non\PYGZhy{}null  int64  
 5   trip\PYGZus{}distance          22699 non\PYGZhy{}null  float64
 6   RatecodeID             22699 non\PYGZhy{}null  int64  
 7   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     22699 non\PYGZhy{}null  object 
 8   PULocationID           22699 non\PYGZhy{}null  int64  
 9   DOLocationID           22699 non\PYGZhy{}null  int64  
 10  payment\PYGZus{}type           22699 non\PYGZhy{}null  int64  
 11  fare\PYGZus{}amount            22699 non\PYGZhy{}null  float64
 12  extra                  22699 non\PYGZhy{}null  float64
 13  mta\PYGZus{}tax                22699 non\PYGZhy{}null  float64
 14  tip\PYGZus{}amount             22699 non\PYGZhy{}null  float64
 15  tolls\PYGZus{}amount           22699 non\PYGZhy{}null  float64
 16  improvement\PYGZus{}surcharge  22699 non\PYGZhy{}null  float64
 17  total\PYGZus{}amount           22699 non\PYGZhy{}null  float64
dtypes: float64(8), int64(7), object(3)
memory usage: 3.1+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip



\section{Data Visualization}
\label{\detokenize{Automatidata_EDA:data-visualization}}
\sphinxAtStartPar
\sphinxstylestrong{trip distance}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create box plot of trip\PYGZus{}distance}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{orient}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/seaborn/\PYGZus{}base.py:1608: UserWarning: Vertical orientation ignored with only `x` specified.
  warnings.warn(single\PYGZus{}var\PYGZus{}warning.format(\PYGZdq{}Vertical\PYGZdq{}, \PYGZdq{}x\PYGZdq{}))
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}trip\PYGZus{}distance\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{fd188c369da870fc7782d43eddcf651e6864d933b997ed383dba3feb7c14a815}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}trip\PYGZus{}distance\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{a4595d86e51458c3bf4321de29e35a0d7f4502e4d85e66b7e872083d9bae97d5}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}trip\PYGZus{}distance\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{a627c755e35c179a44c44cf1abb14ab0d83e5b77c510b5ea4ee64c0785f24964}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{total amount}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: ylabel=\PYGZsq{}total\PYGZus{}amount\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{a51cad11dd5a415e0f700a1aae857d2158225f97134650c34fa77e8b088176a8}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}total\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{13d96b37b9af73da50b2d9b0695f96587efef26729bcbc2becfe29c712b3bf72}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{tip amount}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: ylabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{8bf7e852cc7efe6fdc5b66cf2f602445f8f39b21e0a1793fc7546efaf284cf5e}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{7088478ab6186b6a8b85b457c9f8039037ec164a399d47f9c1fc28d260a4787b}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{tip\_amount by vendor}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create histogram of tip\PYGZus{}amount by vendor}
\PYG{n}{mask1} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VendorID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{==}\PYG{l+m+mi}{1}
\PYG{n}{df\PYGZus{}mask1} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{n}{mask1}\PYG{p}{]}
\PYG{n}{mask2} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VendorID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{==}\PYG{l+m+mi}{2}
\PYG{n}{df\PYGZus{}mask2} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{n}{mask2}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{df\PYGZus{}mask1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{ac1ad29cd10f957d73e6494f5d8d1bd993ab30847ba91b4d545e8eac94b712fc}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{df\PYGZus{}mask2}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{45b53bddb9cd5758a217e9be3b71e80efd255ab9a0e1cc9e3bc97e90f814d7c7}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Next, zoom in on the upper end of the range of tips to check whether vendor one gets noticeably more of the most generous tips.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create histogram of tip\PYGZus{}amount by vendor for tips \PYGZgt{} \PYGZdl{}10 }
\PYG{n}{tips1} \PYG{o}{=} \PYG{n}{df\PYGZus{}mask1}\PYG{p}{[}\PYG{n}{df\PYGZus{}mask1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{10}\PYG{p}{]}
\PYG{n}{tips2} \PYG{o}{=} \PYG{n}{df\PYGZus{}mask2}\PYG{p}{[}\PYG{n}{df\PYGZus{}mask2}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{10}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{tips1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{9b264b0a265bec2d7b28dffd9b4b2da7e468c0e732b3e7c11d165e1a84eac092}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{tips2}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{07b4638a01a2927155fc66e232fd3827c2481da424889fed1595de0899ad3dd0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Mean tips by passenger count}

\sphinxAtStartPar
Examine the unique values in the \sphinxcode{\sphinxupquote{passenger\_count}} column.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{passengers} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{passenger\PYGZus{}count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{passengers}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
array([6, 1, 2, 4, 5, 3, 0])
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Calculate mean tips by passenger\PYGZus{}count}
\PYG{n}{mean\PYGZus{}tips} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{passenger\PYGZus{}count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{mean\PYGZus{}tips}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
passenger\PYGZus{}count
0    2.135758
1    1.848920
2    1.856378
3    1.716768
4    1.530264
5    1.873185
6    1.720260
Name: tip\PYGZus{}amount, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create bar plot for mean tips by passenger count}
\PYG{n}{mean\PYGZus{}tips}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{bar}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}passenger\PYGZus{}count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{7f41baed201d35edc38d43f870357df47dc252961e3cb523d9c6d39f6145c051}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Create month and day columns}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{datetime} \PYG{k}{as} \PYG{n+nn}{dt}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m/}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{I:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m/}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{I:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a month column}
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{month\PYGZus{}name}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Create a day column}
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{day\PYGZus{}name}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a month column}
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{month}

\PYG{c+c1}{\PYGZsh{} Create a day column}
\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{day}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0        24870114         2  2017\PYGZhy{}03\PYGZhy{}25 08:55:43   2017\PYGZhy{}03\PYGZhy{}25 09:09:47   
1        35634249         1  2017\PYGZhy{}04\PYGZhy{}11 14:53:28   2017\PYGZhy{}04\PYGZhy{}11 15:19:58   
2       106203690         1  2017\PYGZhy{}12\PYGZhy{}15 07:26:56   2017\PYGZhy{}12\PYGZhy{}15 07:34:08   
3        38942136         2  2017\PYGZhy{}05\PYGZhy{}07 13:17:59   2017\PYGZhy{}05\PYGZhy{}07 13:48:14   
4        30841670         2  2017\PYGZhy{}04\PYGZhy{}15 23:32:20   2017\PYGZhy{}04\PYGZhy{}15 23:49:03   
...           ...       ...                  ...                   ...   
22694    14873857         2  2017\PYGZhy{}02\PYGZhy{}24 17:37:23   2017\PYGZhy{}02\PYGZhy{}24 17:40:39   
22695    66632549         2  2017\PYGZhy{}08\PYGZhy{}06 16:43:59   2017\PYGZhy{}08\PYGZhy{}06 17:24:47   
22696    74239933         2  2017\PYGZhy{}09\PYGZhy{}04 14:54:14   2017\PYGZhy{}09\PYGZhy{}04 14:58:22   
22697    60217333         2  2017\PYGZhy{}07\PYGZhy{}15 12:56:30   2017\PYGZhy{}07\PYGZhy{}15 13:08:26   
22698    17208911         1  2017\PYGZhy{}03\PYGZhy{}02 13:02:49   2017\PYGZhy{}03\PYGZhy{}02 13:16:09   

       passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                    6           3.34           1                  N   
1                    1           1.80           1                  N   
2                    1           1.00           1                  N   
3                    1           3.70           1                  N   
4                    1           4.37           1                  N   
...                ...            ...         ...                ...   
22694                3           0.61           1                  N   
22695                1          16.71           2                  N   
22696                1           0.42           1                  N   
22697                1           2.36           1                  N   
22698                1           2.10           1                  N   

       PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0               100           231             1         13.0    0.0      0.5   
1               186            43             1         16.0    0.0      0.5   
2               262           236             1          6.5    0.0      0.5   
3               188            97             1         20.5    0.0      0.5   
4                 4           112             2         16.5    0.5      0.5   
...             ...           ...           ...          ...    ...      ...   
22694            48           186             2          4.0    1.0      0.5   
22695           132           164             1         52.0    0.0      0.5   
22696           107           234             2          4.5    0.0      0.5   
22697            68           144             1         10.5    0.0      0.5   
22698           239           236             1         11.0    0.0      0.5   

       tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  Month  \PYGZbs{}
0            2.76          0.00                    0.3         16.56      3   
1            4.00          0.00                    0.3         20.80      4   
2            1.45          0.00                    0.3          8.75     12   
3            6.39          0.00                    0.3         27.69      5   
4            0.00          0.00                    0.3         17.80      4   
...           ...           ...                    ...           ...    ...   
22694        0.00          0.00                    0.3          5.80      2   
22695       14.64          5.76                    0.3         73.20      8   
22696        0.00          0.00                    0.3          5.30      9   
22697        1.70          0.00                    0.3         13.00      7   
22698        2.35          0.00                    0.3         14.15      3   

       Day  
0       25  
1       11  
2       15  
3        7  
4       15  
...    ...  
22694   24  
22695    6  
22696    4  
22697   15  
22698    2  

[22699 rows x 20 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Plot total ride count by month}

\sphinxAtStartPar
Begin by calculating total ride count by month.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get total number of rides for each month}
\PYG{n}{monthly\PYGZus{}rides} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{value\PYGZus{}counts}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df} \PYG{o}{=} \PYG{n}{monthly\PYGZus{}rides}\PYG{o}{.}\PYG{n}{to\PYGZus{}frame}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Reorder the results to put the months in calendar order.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Reorder the monthly ride list so months go in order}
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
    Month  Count
4       1   1997
8       2   1769
0       3   2049
2       4   2019
3       5   2013
5       6   1964
11      7   1697
10      8   1724
9       9   1734
1      10   2027
7      11   1843
6      12   1863
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Show the index}
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{o}{.}\PYG{n}{index}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Index([4, 8, 0, 2, 3, 5, 11, 10, 9, 1, 7, 6], dtype=\PYGZsq{}int64\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a bar plot of total rides per month}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{barplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{data}\PYG{o}{=}\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}Month\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{8dd7cdb24c3c19dd96871762087996afdf29cced99bdd7d55f3d8615a9295771}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Plot total ride count by day}

\sphinxAtStartPar
Repeat the above process, but now calculate the total rides by day of the week.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{daily\PYGZus{}rides} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{value\PYGZus{}counts}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{daily\PYGZus{}rides\PYGZus{}df} \PYG{o}{=} \PYG{n}{daily\PYGZus{}rides}\PYG{o}{.}\PYG{n}{to\PYGZus{}frame}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Repeat the above process, this time for rides by day}
\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
    Day  Count
20    1    721
16    2    739
0     3    810
25    4    703
14    5    746
21    6    718
5     7    788
13    8    752
22    9    714
11   10    760
4    11    788
3    12    791
8    13    782
15   14    742
10   15    761
12   16    759
2    17    795
1    18    806
7    19    784
19   20    727
6    21    788
17   22    735
28   23    663
24   24    703
23   25    708
26   26    695
18   27    732
9    28    763
29   29    649
27   30    669
30   31    408
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create bar plot for ride count by day}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{barplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{data}\PYG{o}{=}\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}Day\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{3de1b64a3c762203e4a739e5554ff1a4192deb973bd09a504fa7b81cf24b086c}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Plot total revenue by day of the week}

\sphinxAtStartPar
Repeat the above process, but now calculate the total revenue by day of the week.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Repeat the process, this time for total revenue by day}
\PYG{n}{revenue} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{revenue} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{revenue}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Revenue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{revenue}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create bar plot of total revenue by day}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{barplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Revenue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{data}\PYG{o}{=}\PYG{n}{daily\PYGZus{}rides\PYGZus{}df}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xticks}\PYG{p}{(}\PYG{n}{rotation}\PYG{o}{=}\PYG{l+m+mi}{90}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{ae6d93c5ba2b83333fdd1454faf1340458c182cadb67bcda7d249221e583d4b3}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Plot total revenue by month}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Repeat the process, this time for total revenue by month}
\PYG{n}{revenue\PYGZus{}month} \PYG{o}{=} \PYG{n}{df}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{revenue\PYGZus{}month} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{revenue\PYGZus{}month}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Revenue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{revenue\PYGZus{}month}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a bar plot of total revenue by month}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{barplot}\PYG{p}{(}\PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Revenue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{data}\PYG{o}{=}\PYG{n}{monthly\PYGZus{}rides\PYGZus{}df}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{35e077f6330917569a3c781adfa4726f5c79ceff590dcbb0b092dec4e9d8bc0f}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Scatter plot from Tableau}

\sphinxAtStartPar
\sphinxincludegraphics{{Sheet 1}.png}

\sphinxstepscope


\chapter{Statistical Analysis}
\label{\detokenize{Automatidata_Statistical Analysis:statistical-analysis}}\label{\detokenize{Automatidata_Statistical Analysis::doc}}
\sphinxAtStartPar
You are a data professional in a data consulting firm, called Automatidata. The current project for their newest client, the New York City Taxi \& Limousine Commission (New York City TLC) is reaching its midpoint, having completed a project proposal, Python coding work, and exploratory data analysis.

\sphinxAtStartPar
You receive a new email from Uli King, Automatidata’s project manager. Uli tells your team about a new request from the New York City TLC: to analyze the relationship between fare amount and payment type. A follow\sphinxhyphen{}up email from Luana includes your specific assignment: to conduct an A/B test.

\sphinxAtStartPar
A notebook was structured and prepared to help you in this project. Please complete the following questions.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{from} \PYG{n+nn}{scipy} \PYG{k+kn}{import} \PYG{n}{stats}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{seaborn} \PYG{k}{as} \PYG{n+nn}{sns}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Load dataset into dataframe}
\PYG{n}{taxi} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2017\PYGZus{}Yellow\PYGZus{}Taxi\PYGZus{}Trip\PYGZus{}Data.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{index\PYGZus{}col} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{taxi}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
           VendorID    tpep\PYGZus{}pickup\PYGZus{}datetime   tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
24870114          2   03/25/2017 8:55:43 AM   03/25/2017 9:09:47 AM   
35634249          1   04/11/2017 2:53:28 PM   04/11/2017 3:19:58 PM   
106203690         1   12/15/2017 7:26:56 AM   12/15/2017 7:34:08 AM   
38942136          2   05/07/2017 1:17:59 PM   05/07/2017 1:48:14 PM   
30841670          2  04/15/2017 11:32:20 PM  04/15/2017 11:49:03 PM   

           passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
24870114                 6           3.34           1                  N   
35634249                 1           1.80           1                  N   
106203690                1           1.00           1                  N   
38942136                 1           3.70           1                  N   
30841670                 1           4.37           1                  N   

           PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  \PYGZbs{}
24870114            100           231             1         13.0    0.0   
35634249            186            43             1         16.0    0.0   
106203690           262           236             1          6.5    0.0   
38942136            188            97             1         20.5    0.0   
30841670              4           112             2         16.5    0.5   

           mta\PYGZus{}tax  tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  \PYGZbs{}
24870114       0.5        2.76           0.0                    0.3   
35634249       0.5        4.00           0.0                    0.3   
106203690      0.5        1.45           0.0                    0.3   
38942136       0.5        6.39           0.0                    0.3   
30841670       0.5        0.00           0.0                    0.3   

           total\PYGZus{}amount  
24870114          16.56  
35634249          20.80  
106203690          8.75  
38942136          27.69  
30841670          17.80  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{taxi}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
Index: 22699 entries, 24870114 to 17208911
Data columns (total 17 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   VendorID               22699 non\PYGZhy{}null  int64  
 1   tpep\PYGZus{}pickup\PYGZus{}datetime   22699 non\PYGZhy{}null  object 
 2   tpep\PYGZus{}dropoff\PYGZus{}datetime  22699 non\PYGZhy{}null  object 
 3   passenger\PYGZus{}count        22699 non\PYGZhy{}null  int64  
 4   trip\PYGZus{}distance          22699 non\PYGZhy{}null  float64
 5   RatecodeID             22699 non\PYGZhy{}null  int64  
 6   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     22699 non\PYGZhy{}null  object 
 7   PULocationID           22699 non\PYGZhy{}null  int64  
 8   DOLocationID           22699 non\PYGZhy{}null  int64  
 9   payment\PYGZus{}type           22699 non\PYGZhy{}null  int64  
 10  fare\PYGZus{}amount            22699 non\PYGZhy{}null  float64
 11  extra                  22699 non\PYGZhy{}null  float64
 12  mta\PYGZus{}tax                22699 non\PYGZhy{}null  float64
 13  tip\PYGZus{}amount             22699 non\PYGZhy{}null  float64
 14  tolls\PYGZus{}amount           22699 non\PYGZhy{}null  float64
 15  improvement\PYGZus{}surcharge  22699 non\PYGZhy{}null  float64
 16  total\PYGZus{}amount           22699 non\PYGZhy{}null  float64
dtypes: float64(8), int64(6), object(3)
memory usage: 3.1+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{taxi}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{n}{taxi}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
payment\PYGZus{}type
1    13.429748
2    12.213546
3    12.186116
4     9.913043
Name: fare\PYGZus{}amount, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Before you conduct your hypothesis test, consider the following questions where applicable to complete your code response:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Recall the difference between the null hypothesis and the alternative hypotheses. Consider your hypotheses for this project as listed below.

\end{enumerate}

\sphinxAtStartPar
\(H_0\): There is no difference in the average fare amount between customers who use credit cards and customers who use cash.

\sphinxAtStartPar
\(H_A\): There is a difference in the average fare amount between customers who use credit cards and customers who use cash.

\sphinxAtStartPar
Your goal in this step is to conduct a two\sphinxhyphen{}sample t\sphinxhyphen{}test. Recall the steps for conducting a hypothesis test:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
State the null hypothesis and the alternative hypothesis

\item {} 
\sphinxAtStartPar
Choose a signficance level

\item {} 
\sphinxAtStartPar
Find the p\sphinxhyphen{}value

\item {} 
\sphinxAtStartPar
Reject or fail to reject the null hypothesis

\end{enumerate}

\sphinxAtStartPar
\sphinxstylestrong{Note:} For the purpose of this exercise, your hypothesis test is the main component of your A/B test.

\sphinxAtStartPar
You choose 5\% as the significance level and proceed with a two\sphinxhyphen{}sample t\sphinxhyphen{}test.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{credit\PYGZus{}card} \PYG{o}{=} \PYG{n}{taxi}\PYG{p}{[}\PYG{n}{taxi}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cash} \PYG{o}{=} \PYG{n}{taxi}\PYG{p}{[}\PYG{n}{taxi}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{stats}\PYG{o}{.}\PYG{n}{ttest\PYGZus{}ind}\PYG{p}{(}\PYG{n}{credit\PYGZus{}card}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cash}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{equal\PYGZus{}var}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
TtestResult(statistic=6.866800855655372, pvalue=6.797387473030518e\PYGZhy{}12, df=16675.48547403633)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The p\sphinxhyphen{}value is lower than the significance level and thus we reject the null hypothesis.


\bigskip\hrule\bigskip

\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The key business insight is that encouraging customers to pay with credit cards can generate more revenue for taxi cab drivers.

\item {} 
\sphinxAtStartPar
This project requires an assumption that passengers were forced to pay one way or the other, and that once informed of this requirement, they always complied with it. The data was not collected this way; so, an assumption had to be made to randomly group data entries to perform an A/B test. This dataset does not account for other likely explanations. For example, riders might not carry lots of cash, so it’s easier to pay for longer/farther trips with a credit card. In other words, it’s far more likely that fare amount determines payment type, rather than vice versa.

\end{enumerate}

\sphinxstepscope


\chapter{Regression Analysis}
\label{\detokenize{Automatidata_Regression Analysis:regression-analysis}}\label{\detokenize{Automatidata_Regression Analysis::doc}}
\sphinxAtStartPar
The data consulting firm Automatidata has recently hired you as the newest member of their data analytics team. Their newest client, the NYC Taxi and Limousine Commission (New York City TLC), wants the Automatidata team to build a multiple linear regression model to predict taxi fares using existing data that was collected over the course of a year. The team is getting closer to completing the project, having completed an initial plan of action, initial Python coding work, EDA, and A/B testing.

\sphinxAtStartPar
The Automatidata team has reviewed the results of the A/B testing. Now it’s time to work on predicting the taxi fare amounts. You’ve impressed your Automatidata colleagues with your hard work and attention to detail. The data team believes that you are ready to build the regression model and update the client New York City TLC about your progress.

\sphinxAtStartPar
A notebook was structured and prepared to help you in this project. Please complete the following questions.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Imports}
\PYG{c+c1}{\PYGZsh{} Packages for numerics + dataframes}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}

\PYG{c+c1}{\PYGZsh{} Packages for visualization}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{seaborn} \PYG{k}{as} \PYG{n+nn}{sns}

\PYG{c+c1}{\PYGZsh{} Packages for date conversions for calculating trip durations}
\PYG{k+kn}{from} \PYG{n+nn}{datetime} \PYG{k+kn}{import} \PYG{n}{datetime}
\PYG{k+kn}{from} \PYG{n+nn}{datetime} \PYG{k+kn}{import} \PYG{n}{timedelta}
\PYG{k+kn}{from} \PYG{n+nn}{datetime} \PYG{k+kn}{import} \PYG{n}{date}

\PYG{c+c1}{\PYGZsh{} Packages for OLS, MLR, confusion matrix}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{preprocessing} \PYG{k+kn}{import} \PYG{n}{StandardScaler}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{model\PYGZus{}selection} \PYG{k+kn}{import} \PYG{n}{train\PYGZus{}test\PYGZus{}split}
\PYG{k+kn}{import} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{metrics} \PYG{k}{as} \PYG{n+nn}{metrics} \PYG{c+c1}{\PYGZsh{} For confusion matrix}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{linear\PYGZus{}model} \PYG{k+kn}{import} \PYG{n}{LinearRegression}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{metrics} \PYG{k+kn}{import} \PYG{n}{mean\PYGZus{}absolute\PYGZus{}error}\PYG{p}{,}\PYG{n}{r2\PYGZus{}score}\PYG{p}{,}\PYG{n}{mean\PYGZus{}squared\PYGZus{}error}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{set\PYGZus{}theme}\PYG{p}{(}\PYG{n}{context}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{notebook}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
              \PYG{n}{style}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dark}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} 
              \PYG{n}{palette}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{deep}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\section{EDA}
\label{\detokenize{Automatidata_Regression Analysis:eda}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Load dataset into dataframe }
\PYG{n}{df0}\PYG{o}{=}\PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2017\PYGZus{}Yellow\PYGZus{}Taxi\PYGZus{}Trip\PYGZus{}Data.csv}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} 
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df0}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df0}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(22699, 18)

\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 18 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   Unnamed: 0             22699 non\PYGZhy{}null  int64  
 1   VendorID               22699 non\PYGZhy{}null  int64  
 2   tpep\PYGZus{}pickup\PYGZus{}datetime   22699 non\PYGZhy{}null  object 
 3   tpep\PYGZus{}dropoff\PYGZus{}datetime  22699 non\PYGZhy{}null  object 
 4   passenger\PYGZus{}count        22699 non\PYGZhy{}null  int64  
 5   trip\PYGZus{}distance          22699 non\PYGZhy{}null  float64
 6   RatecodeID             22699 non\PYGZhy{}null  int64  
 7   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     22699 non\PYGZhy{}null  object 
 8   PULocationID           22699 non\PYGZhy{}null  int64  
 9   DOLocationID           22699 non\PYGZhy{}null  int64  
 10  payment\PYGZus{}type           22699 non\PYGZhy{}null  int64  
 11  fare\PYGZus{}amount            22699 non\PYGZhy{}null  float64
 12  extra                  22699 non\PYGZhy{}null  float64
 13  mta\PYGZus{}tax                22699 non\PYGZhy{}null  float64
 14  tip\PYGZus{}amount             22699 non\PYGZhy{}null  float64
 15  tolls\PYGZus{}amount           22699 non\PYGZhy{}null  float64
 16  improvement\PYGZus{}surcharge  22699 non\PYGZhy{}null  float64
 17  total\PYGZus{}amount           22699 non\PYGZhy{}null  float64
dtypes: float64(8), int64(7), object(3)
memory usage: 3.1+ MB
None
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check for missing data and duplicates using .isna() and .drop\PYGZus{}duplicates()}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Shape of df0 with no duplicates for comparison with full df0:}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{df0}\PYG{o}{.}\PYG{n}{drop\PYGZus{}duplicates}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df0}\PYG{o}{.}\PYG{n}{isna}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Shape of df0 with no duplicates for comparison with full df0: (22699, 18)

Unnamed: 0               0
VendorID                 0
tpep\PYGZus{}pickup\PYGZus{}datetime     0
tpep\PYGZus{}dropoff\PYGZus{}datetime    0
passenger\PYGZus{}count          0
trip\PYGZus{}distance            0
RatecodeID               0
store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag       0
PULocationID             0
DOLocationID             0
payment\PYGZus{}type             0
fare\PYGZus{}amount              0
extra                    0
mta\PYGZus{}tax                  0
tip\PYGZus{}amount               0
tolls\PYGZus{}amount             0
improvement\PYGZus{}surcharge    0
total\PYGZus{}amount             0
dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df0}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         Unnamed: 0      VendorID  passenger\PYGZus{}count  trip\PYGZus{}distance  \PYGZbs{}
count  2.269900e+04  22699.000000     22699.000000   22699.000000   
mean   5.675849e+07      1.556236         1.642319       2.913313   
std    3.274493e+07      0.496838         1.285231       3.653171   
min    1.212700e+04      1.000000         0.000000       0.000000   
25\PYGZpc{}    2.852056e+07      1.000000         1.000000       0.990000   
50\PYGZpc{}    5.673150e+07      2.000000         1.000000       1.610000   
75\PYGZpc{}    8.537452e+07      2.000000         2.000000       3.060000   
max    1.134863e+08      2.000000         6.000000      33.960000   

         RatecodeID  PULocationID  DOLocationID  payment\PYGZus{}type   fare\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000  22699.000000   
mean       1.043394    162.412353    161.527997      1.336887     13.026629   
std        0.708391     66.633373     70.139691      0.496211     13.243791   
min        1.000000      1.000000      1.000000      1.000000   \PYGZhy{}120.000000   
25\PYGZpc{}        1.000000    114.000000    112.000000      1.000000      6.500000   
50\PYGZpc{}        1.000000    162.000000    162.000000      1.000000      9.500000   
75\PYGZpc{}        1.000000    233.000000    233.000000      2.000000     14.500000   
max       99.000000    265.000000    265.000000      4.000000    999.990000   

              extra       mta\PYGZus{}tax    tip\PYGZus{}amount  tolls\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000   
mean       0.333275      0.497445      1.835781      0.312542   
std        0.463097      0.039465      2.800626      1.399212   
min       \PYGZhy{}1.000000     \PYGZhy{}0.500000      0.000000      0.000000   
25\PYGZpc{}        0.000000      0.500000      0.000000      0.000000   
50\PYGZpc{}        0.000000      0.500000      1.350000      0.000000   
75\PYGZpc{}        0.500000      0.500000      2.450000      0.000000   
max        4.500000      0.500000    200.000000     19.100000   

       improvement\PYGZus{}surcharge  total\PYGZus{}amount  
count           22699.000000  22699.000000  
mean                0.299551     16.310502  
std                 0.015673     16.097295  
min                \PYGZhy{}0.300000   \PYGZhy{}120.300000  
25\PYGZpc{}                 0.300000      8.750000  
50\PYGZpc{}                 0.300000     11.800000  
75\PYGZpc{}                 0.300000     17.800000  
max                 0.300000   1200.290000  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Convert pickup \& dropoff columns to datetime}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df0}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{*} \PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df0}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0     03/25/2017 8:55:43 AM
1     04/11/2017 2:53:28 PM
2     12/15/2017 7:26:56 AM
3     05/07/2017 1:17:59 PM
4    04/15/2017 11:32:20 PM
Name: tpep\PYGZus{}pickup\PYGZus{}datetime, dtype: object

\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}

0     03/25/2017 9:09:47 AM
1     04/11/2017 3:19:58 PM
2     12/15/2017 7:34:08 AM
3     05/07/2017 1:48:14 PM
4    04/15/2017 11:49:03 PM
Name: tpep\PYGZus{}dropoff\PYGZus{}datetime, dtype: object
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Convert datetime columns to datetime}
\PYG{n}{df1} \PYG{o}{=} \PYG{n}{df0}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{*} \PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{*} \PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{month}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{*} \PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{minute}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0   2017\PYGZhy{}03\PYGZhy{}25 08:55:43
1   2017\PYGZhy{}04\PYGZhy{}11 14:53:28
2   2017\PYGZhy{}12\PYGZhy{}15 07:26:56
3   2017\PYGZhy{}05\PYGZhy{}07 13:17:59
4   2017\PYGZhy{}04\PYGZhy{}15 23:32:20
Name: tpep\PYGZus{}pickup\PYGZus{}datetime, dtype: datetime64[ns]

\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}

0   2017\PYGZhy{}03\PYGZhy{}25 09:09:47
1   2017\PYGZhy{}04\PYGZhy{}11 15:19:58
2   2017\PYGZhy{}12\PYGZhy{}15 07:34:08
3   2017\PYGZhy{}05\PYGZhy{}07 13:48:14
4   2017\PYGZhy{}04\PYGZhy{}15 23:49:03
Name: tpep\PYGZus{}dropoff\PYGZus{}datetime, dtype: datetime64[ns]

\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}

0     3
1     4
2    12
3     5
4     4
Name: tpep\PYGZus{}pickup\PYGZus{}datetime, dtype: int32

\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}\PYGZus{}

0     9
1    19
2    34
3    48
4    49
Name: tpep\PYGZus{}dropoff\PYGZus{}datetime, dtype: int32
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Create duration column}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create `duration` column}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dtype}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
dtype(\PYGZsq{}\PYGZlt{}m8[ns]\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{total\PYGZus{}seconds}\PYG{p}{(}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{60}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0        14.066667
1        26.500000
2         7.200000
3        30.250000
4        16.716667
           ...    
22694     3.266667
22695    40.800000
22696     4.133333
22697    11.933333
22698    13.333333
Name: duration, Length: 22699, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Check for Outliers}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fig} \PYG{p}{,} \PYG{n}{axes} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{3} \PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{n}{sns}\PYG{o}{.}\PYG{n}{violinplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{violinplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{violinplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{ax}\PYG{o}{=}\PYG{n}{axes}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{6997f3a2409a06ce7a0343e0edfb437d3f5060035f4a08f7be00ddf4d1c25efb}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}trip\PYGZus{}distance\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{484d6c085dada734e322d669bf4394724a4441d90d116bfdb9d270900a3b9325}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}fare\PYGZus{}amount\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{169aebe380afa63c8e2a69311a1ca483d6277c595a9adc4a0cb2d86ae7431b2d}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{boxplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{showfliers}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}duration\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{423c4b57d44c6206cc423fe54a72c52a0ed6c7fa30d793d32e284d6b9f7c5265}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Are trip distances of 0 bad data or very short trips rounded down?}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{150}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
22026    0.00
795      0.00
6908     0.00
13561    0.00
12238    0.00
         ... 
7383     0.00
7281     0.00
9155     0.00
5501     0.01
19644    0.01
Name: trip\PYGZus{}distance, Length: 150, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
148
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
count    22699.000000
mean        13.026629
std         13.243791
min       \PYGZhy{}120.000000
25\PYGZpc{}          6.500000
50\PYGZpc{}          9.500000
75\PYGZpc{}         14.500000
max        999.990000
Name: fare\PYGZus{}amount, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Impute values less than \PYGZdl{}0 with 0}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
314       \PYGZhy{}2.5
1646      \PYGZhy{}2.5
4423      \PYGZhy{}3.0
5448      \PYGZhy{}3.5
5758      \PYGZhy{}2.5
8204      \PYGZhy{}3.5
10281     \PYGZhy{}2.5
11204     \PYGZhy{}4.5
12944   \PYGZhy{}120.0
14714     \PYGZhy{}4.0
17602     \PYGZhy{}4.0
18565     \PYGZhy{}3.0
20317     \PYGZhy{}3.5
20698     \PYGZhy{}4.5
Name: fare\PYGZus{}amount, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Series([], Name: fare\PYGZus{}amount, dtype: float64)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
count    22699.000000
mean        13.033832
std         13.212462
min          0.000000
25\PYGZpc{}          6.500000
50\PYGZpc{}          9.500000
75\PYGZpc{}         14.500000
max        999.990000
Name: fare\PYGZus{}amount, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{iqr} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.75}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.25}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{iqr}\PYG{p}{)}
\PYG{n}{maximum} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.75}\PYG{p}{)} \PYG{o}{+} \PYG{p}{(}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{iqr}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{maximum}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
8.0
62.5
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{fare} \PYG{o+ow}{in} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
        \PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{n}{maximum} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{maximum}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0.0
62.5
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Call .describe() for duration outliers}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
count    22699.000000
mean        17.013777
std         61.996482
min        \PYGZhy{}16.983333
25\PYGZpc{}          6.650000
50\PYGZpc{}         11.183333
75\PYGZpc{}         18.383333
max       1439.550000
Name: duration, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Impute a 0 for any negative values}
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Impute the high outliers}
\PYG{n}{iqr} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.75}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.25}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{iqr}\PYG{p}{)}
\PYG{n}{maximum} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{quantile}\PYG{p}{(}\PYG{l+m+mf}{0.75}\PYG{p}{)} \PYG{o}{+} \PYG{p}{(}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{iqr}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{maximum}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
11.733333333333333
88.78333333333333
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{for} \PYG{n}{fare} \PYG{o+ow}{in} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
        \PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{n}{maximum} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{maximum}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0.0
88.78333333333333
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\section{Feature engineering}
\label{\detokenize{Automatidata_Regression Analysis:feature-engineering}}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Create \sphinxcode{\sphinxupquote{mean\_distance}} column}

\sphinxAtStartPar
When deployed, the model will not know the duration of a trip until after the trip occurs, so you cannot train a model that uses this feature. However, you can use the statistics of trips you \sphinxstyleemphasis{do} know to generalize about ones you do not know.

\sphinxAtStartPar
In this step, create a column called \sphinxcode{\sphinxupquote{mean\_distance}} that captures the mean distance for each group of trips that share pickup and dropoff points.

\sphinxAtStartPar
For example, if your data were:

\sphinxAtStartPar
|Trip|Start|End|Distance|
|\textendash{}: |:—:|:\sphinxhyphen{}:|    |
| 1  | A   | B | 1  |
| 2  | C   | D | 2  |
| 3  | A   | B |1.5 |
| 4  | D   | C | 3  |

\sphinxAtStartPar
The results should be:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{A} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{B}\PYG{p}{:} \PYG{l+m+mf}{1.25} \PYG{n}{miles}
\PYG{n}{C} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{D}\PYG{p}{:} \PYG{l+m+mi}{2} \PYG{n}{miles}
\PYG{n}{D} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{C}\PYG{p}{:} \PYG{l+m+mi}{3} \PYG{n}{miles}
\end{sphinxVerbatim}

\sphinxAtStartPar
Notice that C \sphinxhyphen{}\textgreater{} D is not the same as D \sphinxhyphen{}\textgreater{} C. All trips that share a unique pair of start and end points get grouped and averaged.

\sphinxAtStartPar
Then, a new column \sphinxcode{\sphinxupquote{mean\_distance}} will be added where the value at each row is the average for all trips with those pickup and dropoff locations:


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TTTTT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
Trip
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Start
&\sphinxstyletheadfamily 
\sphinxAtStartPar
End
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Distance
&\sphinxstyletheadfamily 
\sphinxAtStartPar
mean\_distance
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
1
&
\sphinxAtStartPar
A
&
\sphinxAtStartPar
B
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
1.25
\\
\sphinxhline
\sphinxAtStartPar
2
&
\sphinxAtStartPar
C
&
\sphinxAtStartPar
D
&
\sphinxAtStartPar
2
&
\sphinxAtStartPar
2
\\
\sphinxhline
\sphinxAtStartPar
3
&
\sphinxAtStartPar
A
&
\sphinxAtStartPar
B
&
\sphinxAtStartPar
1.5
&
\sphinxAtStartPar
1.25
\\
\sphinxhline
\sphinxAtStartPar
4
&
\sphinxAtStartPar
D
&
\sphinxAtStartPar
C
&
\sphinxAtStartPar
3
&
\sphinxAtStartPar
3
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Begin by creating a helper column called \sphinxcode{\sphinxupquote{pickup\_dropoff}}, which contains the unique combination of pickup and dropoff location IDs for each row.

\sphinxAtStartPar
One way to do this is to convert the pickup and dropoff location IDs to strings and join them, separated by a space. The space is to ensure that, for example, a trip with pickup/dropoff points of 12 \& 151 gets encoded differently than a trip with points 121 \& 51.

\sphinxAtStartPar
So, the new column would look like this:


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TTTT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
Trip
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Start
&\sphinxstyletheadfamily 
\sphinxAtStartPar
End
&\sphinxstyletheadfamily 
\sphinxAtStartPar
pickup\_dropoff
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
1
&
\sphinxAtStartPar
A
&
\sphinxAtStartPar
B
&
\sphinxAtStartPar
‘A B’
\\
\sphinxhline
\sphinxAtStartPar
2
&
\sphinxAtStartPar
C
&
\sphinxAtStartPar
D
&
\sphinxAtStartPar
‘C D’
\\
\sphinxhline
\sphinxAtStartPar
3
&
\sphinxAtStartPar
A
&
\sphinxAtStartPar
B
&
\sphinxAtStartPar
‘A B’
\\
\sphinxhline
\sphinxAtStartPar
4
&
\sphinxAtStartPar
D
&
\sphinxAtStartPar
C
&
\sphinxAtStartPar
‘D C’
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create `pickup\PYGZus{}dropoff` column}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PULocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOLocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0    100 231
1     186 43
Name: pickup\PYGZus{}dropoff, dtype: object
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{grouped} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{numeric\PYGZus{}only}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{grouped}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
                trip\PYGZus{}distance
pickup\PYGZus{}dropoff               
1 1                  2.433333
10 148              15.700000
100 1               16.890000
100 100              0.253333
100 107              1.180000
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Convert `grouped` to a dictionary}
\PYG{n}{grouped\PYGZus{}dict} \PYG{o}{=} \PYG{n}{grouped}\PYG{o}{.}\PYG{n}{to\PYGZus{}dict}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2. Reassign to only contain the inner dictionary}
\PYG{n}{grouped\PYGZus{}dict} \PYG{o}{=} \PYG{n}{grouped\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Create a mean\PYGZus{}distance column that is a copy of the pickup\PYGZus{}dropoff helper column}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} 2. Map `grouped\PYGZus{}dict` to the `mean\PYGZus{}distance` column}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{map}\PYG{p}{(}\PYG{n}{grouped\PYGZus{}dict}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Confirm that it worked}
\PYG{n}{df1}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PULocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{100}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOLocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{202}\PYG{p}{)}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
9304   112330762         1  2017\PYGZhy{}01\PYGZhy{}18 15:51:53   2017\PYGZhy{}01\PYGZhy{}18 16:31:14   

      passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
9304                1            5.3           1                  N   

      PULocationID  DOLocationID  ...  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
9304           100           202  ...         26.0    0.0      0.5   

      tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  duration  \PYGZbs{}
9304         2.0           0.0                    0.3          28.8     39.35   

      pickup\PYGZus{}dropoff mean\PYGZus{}distance  
9304         100 202           5.3  

[1 rows x 21 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{grouped} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{numeric\PYGZus{}only}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{grouped}

\PYG{c+c1}{\PYGZsh{} Create a dictionary where keys are unique pickup\PYGZus{}dropoffs and values are}
\PYG{c+c1}{\PYGZsh{} mean trip duration for all trips with those pickup\PYGZus{}dropoff combos}
\PYG{n}{grouped\PYGZus{}dict} \PYG{o}{=} \PYG{n}{grouped}\PYG{o}{.}\PYG{n}{to\PYGZus{}dict}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{grouped\PYGZus{}dict} \PYG{o}{=} \PYG{n}{grouped\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{map}\PYG{p}{(}\PYG{n}{grouped\PYGZus{}dict}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Confirm that it worked}
\PYG{n}{df1}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PULocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{==}\PYG{l+m+mi}{100}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOLocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{==}\PYG{l+m+mi}{231}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       mean\PYGZus{}duration
0          22.847222
4909       22.847222
16636      22.847222
18134      22.847222
19761      22.847222
20581      22.847222
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}day\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{day\PYGZus{}name}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}month\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0        24870114         2  2017\PYGZhy{}03\PYGZhy{}25 08:55:43   2017\PYGZhy{}03\PYGZhy{}25 09:09:47   
1        35634249         1  2017\PYGZhy{}04\PYGZhy{}11 14:53:28   2017\PYGZhy{}04\PYGZhy{}11 15:19:58   
2       106203690         1  2017\PYGZhy{}12\PYGZhy{}15 07:26:56   2017\PYGZhy{}12\PYGZhy{}15 07:34:08   
3        38942136         2  2017\PYGZhy{}05\PYGZhy{}07 13:17:59   2017\PYGZhy{}05\PYGZhy{}07 13:48:14   
4        30841670         2  2017\PYGZhy{}04\PYGZhy{}15 23:32:20   2017\PYGZhy{}04\PYGZhy{}15 23:49:03   
...           ...       ...                  ...                   ...   
22694    14873857         2  2017\PYGZhy{}02\PYGZhy{}24 17:37:23   2017\PYGZhy{}02\PYGZhy{}24 17:40:39   
22695    66632549         2  2017\PYGZhy{}08\PYGZhy{}06 16:43:59   2017\PYGZhy{}08\PYGZhy{}06 17:24:47   
22696    74239933         2  2017\PYGZhy{}09\PYGZhy{}04 14:54:14   2017\PYGZhy{}09\PYGZhy{}04 14:58:22   
22697    60217333         2  2017\PYGZhy{}07\PYGZhy{}15 12:56:30   2017\PYGZhy{}07\PYGZhy{}15 13:08:26   
22698    17208911         1  2017\PYGZhy{}03\PYGZhy{}02 13:02:49   2017\PYGZhy{}03\PYGZhy{}02 13:16:09   

       passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                    6           3.34           1                  N   
1                    1           1.80           1                  N   
2                    1           1.00           1                  N   
3                    1           3.70           1                  N   
4                    1           4.37           1                  N   
...                ...            ...         ...                ...   
22694                3           0.61           1                  N   
22695                1          16.71           2                  N   
22696                1           0.42           1                  N   
22697                1           2.36           1                  N   
22698                1           2.10           1                  N   

       PULocationID  DOLocationID  ...  tip\PYGZus{}amount  tolls\PYGZus{}amount  \PYGZbs{}
0               100           231  ...        2.76          0.00   
1               186            43  ...        4.00          0.00   
2               262           236  ...        1.45          0.00   
3               188            97  ...        6.39          0.00   
4                 4           112  ...        0.00          0.00   
...             ...           ...  ...         ...           ...   
22694            48           186  ...        0.00          0.00   
22695           132           164  ...       14.64          5.76   
22696           107           234  ...        0.00          0.00   
22697            68           144  ...        1.70          0.00   
22698           239           236  ...        2.35          0.00   

       improvement\PYGZus{}surcharge  total\PYGZus{}amount   duration  pickup\PYGZus{}dropoff  \PYGZbs{}
0                        0.3         16.56  14.066667         100 231   
1                        0.3         20.80  26.500000          186 43   
2                        0.3          8.75   7.200000         262 236   
3                        0.3         27.69  30.250000          188 97   
4                        0.3         17.80  16.716667           4 112   
...                      ...           ...        ...             ...   
22694                    0.3          5.80   3.266667          48 186   
22695                    0.3         73.20  40.800000         132 164   
22696                    0.3          5.30   4.133333         107 234   
22697                    0.3         13.00  11.933333          68 144   
22698                    0.3         14.15  13.333333         239 236   

       mean\PYGZus{}distance  mean\PYGZus{}duration       day month  
0           3.521667      22.847222  Saturday   Mar  
1           3.108889      24.470370   Tuesday   Apr  
2           0.881429       7.250000    Friday   Dec  
3           3.700000      30.250000    Sunday   May  
4           4.435000      14.616667  Saturday   Apr  
...              ...            ...       ...   ...  
22694       1.098214       8.594643    Friday   Feb  
22695      18.757500      59.560417    Sunday   Aug  
22696       0.684242       6.609091    Monday   Sep  
22697       2.077500      16.650000  Saturday   Jul  
22698       1.476970       9.405556  Thursday   Mar  

[22699 rows x 24 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}\begin{itemize}
\item {} 
\sphinxAtStartPar
Any weekday (not Saturday or Sunday) AND

\item {} 
\sphinxAtStartPar
Either from 06:00\textendash{}10:00 or from 16:00\textendash{}20:00

\end{itemize}

\sphinxAtStartPar
Create a binary \sphinxcode{\sphinxupquote{rush\_hour}} column that contains a 1 if the ride was during rush hour and a 0 if it was not.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}rush\PYGZus{}hour\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{hour}

\PYG{c+c1}{\PYGZsh{} If day is Saturday or Sunday, impute 0 in `rush\PYGZus{}hour` column}
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Saturday}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{|} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sunday}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2  2017\PYGZhy{}03\PYGZhy{}25 08:55:43   2017\PYGZhy{}03\PYGZhy{}25 09:09:47   
1    35634249         1  2017\PYGZhy{}04\PYGZhy{}11 14:53:28   2017\PYGZhy{}04\PYGZhy{}11 15:19:58   
2   106203690         1  2017\PYGZhy{}12\PYGZhy{}15 07:26:56   2017\PYGZhy{}12\PYGZhy{}15 07:34:08   
3    38942136         2  2017\PYGZhy{}05\PYGZhy{}07 13:17:59   2017\PYGZhy{}05\PYGZhy{}07 13:48:14   
4    30841670         2  2017\PYGZhy{}04\PYGZhy{}15 23:32:20   2017\PYGZhy{}04\PYGZhy{}15 23:49:03   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   
1                1           1.80           1                  N   
2                1           1.00           1                  N   
3                1           3.70           1                  N   
4                1           4.37           1                  N   

   PULocationID  DOLocationID  ...  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  \PYGZbs{}
0           100           231  ...           0.0                    0.3   
1           186            43  ...           0.0                    0.3   
2           262           236  ...           0.0                    0.3   
3           188            97  ...           0.0                    0.3   
4             4           112  ...           0.0                    0.3   

   total\PYGZus{}amount   duration  pickup\PYGZus{}dropoff  mean\PYGZus{}distance  mean\PYGZus{}duration  \PYGZbs{}
0         16.56  14.066667         100 231       3.521667      22.847222   
1         20.80  26.500000          186 43       3.108889      24.470370   
2          8.75   7.200000         262 236       0.881429       7.250000   
3         27.69  30.250000          188 97       3.700000      30.250000   
4         17.80  16.716667           4 112       4.435000      14.616667   

        day  month rush\PYGZus{}hour  
0  Saturday    Mar         0  
1   Tuesday    Apr        14  
2    Friday    Dec         7  
3    Sunday    May         0  
4  Saturday    Apr         0  

[5 rows x 25 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{rush\PYGZus{}hourizer}\PYG{p}{(}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{l+m+mi}{6} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{10}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{elif} \PYG{l+m+mi}{16} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{20}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{val}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Apply the `rush\PYGZus{}hourizer()` function to the new column}
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Saturday}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{df1}\PYG{o}{.}\PYG{n}{day} \PYG{o}{!=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sunday}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{rush\PYGZus{}hourizer} \PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70633/1505293423.py:2: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value \PYGZsq{}[0 1 1 ... 1 0 0]\PYGZsq{} has dtype incompatible with int32, please explicitly cast to a compatible dtype first.
  df1.loc[(df1[\PYGZsq{}day\PYGZsq{}] != \PYGZsq{}Saturday\PYGZsq{}) \PYGZam{} (df1.day != \PYGZsq{}Sunday\PYGZsq{}) , \PYGZsq{}rush\PYGZus{}hour\PYGZsq{}] = df1.apply(rush\PYGZus{}hourizer , axis=1)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rush\PYGZus{}hour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
count    22699.000000
mean         0.296753
std          0.456837
min          0.000000
25\PYGZpc{}          0.000000
50\PYGZpc{}          0.000000
75\PYGZpc{}          1.000000
max          1.000000
Name: rush\PYGZus{}hour, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Scatter Plot}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a scatterplot to visualize the relationship between variables of interest}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{scatterplot}\PYG{p}{(}\PYG{n}{data} \PYG{o}{=} \PYG{n}{df1} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{markers}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}mean\PYGZus{}duration\PYGZsq{}, ylabel=\PYGZsq{}fare\PYGZus{}amount\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{f819f2a3c3438970a40b6973dee38165193842addba63fd226e71f836ab518e3}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{50}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{value\PYGZus{}counts}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
fare\PYGZus{}amount
52.0    514
62.5     84
59.0      9
50.5      9
57.5      8
51.0      7
60.0      6
55.0      6
51.5      6
53.0      4
52.5      4
61.0      3
62.0      3
55.5      3
56.0      3
56.5      3
58.5      2
59.5      2
61.5      2
57.0      2
54.0      2
58.0      1
54.7      1
54.5      1
Name: count, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set pandas to display all columns}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{set\PYGZus{}option}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{display.max\PYGZus{}columns}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{k+kc}{None}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{52}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{30}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
11      18600059         2  2017\PYGZhy{}03\PYGZhy{}05 19:15:30   2017\PYGZhy{}03\PYGZhy{}05 19:52:18   
110     47959795         1  2017\PYGZhy{}06\PYGZhy{}03 14:24:57   2017\PYGZhy{}06\PYGZhy{}03 15:31:48   
161     95729204         2  2017\PYGZhy{}11\PYGZhy{}11 20:16:16   2017\PYGZhy{}11\PYGZhy{}11 20:17:14   
247    103404868         2  2017\PYGZhy{}12\PYGZhy{}06 23:37:08   2017\PYGZhy{}12\PYGZhy{}07 00:06:19   
379     80479432         2  2017\PYGZhy{}09\PYGZhy{}24 23:45:45   2017\PYGZhy{}09\PYGZhy{}25 00:15:14   
388     16226157         1  2017\PYGZhy{}02\PYGZhy{}28 18:30:05   2017\PYGZhy{}02\PYGZhy{}28 19:09:55   
406     55253442         2  2017\PYGZhy{}06\PYGZhy{}05 12:51:58   2017\PYGZhy{}06\PYGZhy{}05 13:07:35   
449     65900029         2  2017\PYGZhy{}08\PYGZhy{}03 22:47:14   2017\PYGZhy{}08\PYGZhy{}03 23:32:41   
468     80904240         2  2017\PYGZhy{}09\PYGZhy{}26 13:48:26   2017\PYGZhy{}09\PYGZhy{}26 14:31:17   
520     33706214         2  2017\PYGZhy{}04\PYGZhy{}23 21:34:48   2017\PYGZhy{}04\PYGZhy{}23 22:46:23   
569     99259872         2  2017\PYGZhy{}11\PYGZhy{}22 21:31:32   2017\PYGZhy{}11\PYGZhy{}22 22:00:25   
572     61050418         2  2017\PYGZhy{}07\PYGZhy{}18 13:29:06   2017\PYGZhy{}07\PYGZhy{}18 13:29:19   
586     54444647         2  2017\PYGZhy{}06\PYGZhy{}26 13:39:12   2017\PYGZhy{}06\PYGZhy{}26 14:34:54   
692     94424289         2  2017\PYGZhy{}11\PYGZhy{}07 22:15:00   2017\PYGZhy{}11\PYGZhy{}07 22:45:32   
717    103094220         1  2017\PYGZhy{}12\PYGZhy{}06 05:19:50   2017\PYGZhy{}12\PYGZhy{}06 05:53:52   
719     66115834         1  2017\PYGZhy{}08\PYGZhy{}04 17:53:34   2017\PYGZhy{}08\PYGZhy{}04 18:50:56   
782     55934137         2  2017\PYGZhy{}06\PYGZhy{}09 09:31:25   2017\PYGZhy{}06\PYGZhy{}09 10:24:10   
816     13731926         2  2017\PYGZhy{}02\PYGZhy{}21 06:11:03   2017\PYGZhy{}02\PYGZhy{}21 06:59:39   
818     52277743         2  2017\PYGZhy{}06\PYGZhy{}20 08:15:18   2017\PYGZhy{}06\PYGZhy{}20 10:24:37   
835      2684305         2  2017\PYGZhy{}01\PYGZhy{}10 22:29:47   2017\PYGZhy{}01\PYGZhy{}10 23:06:46   
840     90860814         2  2017\PYGZhy{}10\PYGZhy{}27 21:50:00   2017\PYGZhy{}10\PYGZhy{}27 22:35:04   
861    106575186         1  2017\PYGZhy{}12\PYGZhy{}16 06:39:59   2017\PYGZhy{}12\PYGZhy{}16 07:07:59   
881    110495611         2  2017\PYGZhy{}12\PYGZhy{}30 05:25:29   2017\PYGZhy{}12\PYGZhy{}30 06:01:29   
958     87017503         1  2017\PYGZhy{}10\PYGZhy{}15 22:39:12   2017\PYGZhy{}10\PYGZhy{}15 23:14:22   
970     12762608         2  2017\PYGZhy{}02\PYGZhy{}17 20:39:42   2017\PYGZhy{}02\PYGZhy{}17 21:13:29   
984     71264442         1  2017\PYGZhy{}08\PYGZhy{}23 18:23:26   2017\PYGZhy{}08\PYGZhy{}23 19:18:29   
1082    11006300         2  2017\PYGZhy{}02\PYGZhy{}07 17:20:19   2017\PYGZhy{}02\PYGZhy{}07 17:34:41   
1097    68882036         2  2017\PYGZhy{}08\PYGZhy{}14 23:01:15   2017\PYGZhy{}08\PYGZhy{}14 23:03:35   
1110    74720333         1  2017\PYGZhy{}09\PYGZhy{}06 10:46:17   2017\PYGZhy{}09\PYGZhy{}06 11:44:41   
1179    51937907         2  2017\PYGZhy{}06\PYGZhy{}19 06:23:13   2017\PYGZhy{}06\PYGZhy{}19 07:03:53   

      passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
11                  2          18.90           2                  N   
110                 1          18.00           2                  N   
161                 1           0.23           2                  N   
247                 1          18.93           2                  N   
379                 1          17.99           2                  N   
388                 1          18.40           2                  N   
406                 1           4.73           2                  N   
449                 2          18.21           2                  N   
468                 1          17.27           2                  N   
520                 6          18.34           2                  N   
569                 1          18.65           2                  N   
572                 1           0.00           2                  N   
586                 1          17.76           2                  N   
692                 2          16.97           2                  N   
717                 1          20.80           2                  N   
719                 1          21.60           2                  N   
782                 2          18.81           2                  N   
816                 5          16.94           2                  N   
818                 1          17.77           2                  N   
835                 1          18.57           2                  N   
840                 1          22.43           2                  N   
861                 2          17.80           2                  N   
881                 6          18.23           2                  N   
958                 1          21.80           2                  N   
970                 1          19.57           2                  N   
984                 1          16.70           2                  N   
1082                1           1.09           2                  N   
1097                5           2.12           2                  N   
1110                1          19.10           2                  N   
1179                6          19.77           2                  N   

      PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
11             236           132             1         52.0    0.0      0.5   
110            132           163             1         52.0    0.0      0.5   
161            132           132             2         52.0    0.0      0.5   
247            132            79             2         52.0    0.0      0.5   
379            132           234             1         52.0    0.0      0.5   
388            132            48             2         52.0    4.5      0.5   
406            228            88             2         52.0    0.0      0.5   
449            132            48             2         52.0    0.0      0.5   
468            186           132             2         52.0    0.0      0.5   
520            132           148             1         52.0    0.0      0.5   
569            132           144             1         52.0    0.0      0.5   
572            230           161             1         52.0    0.0      0.5   
586            211           132             1         52.0    0.0      0.5   
692            132           170             1         52.0    0.0      0.5   
717            132           239             1         52.0    0.0      0.5   
719            264           264             1         52.0    4.5      0.5   
782            163           132             1         52.0    0.0      0.5   
816            132           170             1         52.0    0.0      0.5   
818            132           246             1         52.0    0.0      0.5   
835            132            48             1         52.0    0.0      0.5   
840            132           163             2         52.0    0.0      0.5   
861             75           132             1         52.0    0.0      0.5   
881             68           132             2         52.0    0.0      0.5   
958            132           261             2         52.0    0.0      0.5   
970            132           140             1         52.0    0.0      0.5   
984            132           230             1         52.0    4.5      0.5   
1082           170            48             2         52.0    4.5      0.5   
1097           265           265             2         52.0    0.0      0.5   
1110           239           132             1         52.0    0.0      0.5   
1179           238           132             1         52.0    0.0      0.5   

      tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  \PYGZbs{}
11         14.58          5.54                    0.3         72.92   
110         0.00          0.00                    0.3         52.80   
161         0.00          0.00                    0.3         52.80   
247         0.00          0.00                    0.3         52.80   
379        14.64          5.76                    0.3         73.20   
388         0.00          5.54                    0.3         62.84   
406         0.00          5.76                    0.3         58.56   
449         0.00          5.76                    0.3         58.56   
468         0.00          5.76                    0.3         58.56   
520         5.00          0.00                    0.3         57.80   
569        10.56          0.00                    0.3         63.36   
572        11.71          5.76                    0.3         70.27   
586        11.71          5.76                    0.3         70.27   
692        11.71          5.76                    0.3         70.27   
717         5.85          5.76                    0.3         64.41   
719        12.60          5.76                    0.3         75.66   
782        13.20          0.00                    0.3         66.00   
816         2.00          5.54                    0.3         60.34   
818        11.71          5.76                    0.3         70.27   
835        13.20          0.00                    0.3         66.00   
840         0.00          5.76                    0.3         58.56   
861         6.00          5.76                    0.3         64.56   
881         0.00          0.00                    0.3         52.80   
958         0.00          0.00                    0.3         52.80   
970        11.67          5.54                    0.3         70.01   
984        42.29          0.00                    0.3         99.59   
1082        0.00          5.54                    0.3         62.84   
1097        0.00          0.00                    0.3         52.80   
1110       15.80          0.00                    0.3         68.60   
1179       17.57          5.76                    0.3         76.13   

       duration pickup\PYGZus{}dropoff  mean\PYGZus{}distance  mean\PYGZus{}duration        day month  \PYGZbs{}
11    36.800000        236 132      19.211667      40.500000     Sunday   Mar   
110   66.850000        132 163      19.229000      52.941667   Saturday   Jun   
161    0.966667        132 132       2.255862       3.021839   Saturday   Nov   
247   29.183333         132 79      19.431667      47.275000  Wednesday   Dec   
379   29.483333        132 234      17.654000      49.833333     Sunday   Sep   
388   39.833333         132 48      18.761905      58.246032    Tuesday   Feb   
406   15.616667         228 88       4.730000      15.616667     Monday   Jun   
449   45.450000         132 48      18.761905      58.246032   Thursday   Aug   
468   42.850000        186 132      17.096000      42.920000    Tuesday   Sep   
520   71.583333        132 148      17.994286      46.340476     Sunday   Apr   
569   28.883333        132 144      18.537500      37.000000  Wednesday   Nov   
572    0.216667        230 161       0.685484       7.965591    Tuesday   Jul   
586   55.700000        211 132      16.580000      61.691667     Monday   Jun   
692   30.533333        132 170      17.203000      37.113333    Tuesday   Nov   
717   34.033333        132 239      20.901250      44.862500  Wednesday   Dec   
719   57.366667        264 264       3.191516      15.618773     Friday   Aug   
782   52.750000        163 132      17.275833      52.338889     Friday   Jun   
816   48.600000        132 170      17.203000      37.113333    Tuesday   Feb   
818   88.783333        132 246      18.515000      66.316667    Tuesday   Jun   
835   36.983333         132 48      18.761905      58.246032    Tuesday   Jan   
840   45.066667        132 163      19.229000      52.941667     Friday   Oct   
861   28.000000         75 132      18.442500      36.204167   Saturday   Dec   
881   36.000000         68 132      18.785000      58.041667   Saturday   Dec   
958   35.166667        132 261      22.115000      51.493750     Sunday   Oct   
970   33.783333        132 140      19.293333      36.791667     Friday   Feb   
984   55.050000        132 230      18.571200      59.598000  Wednesday   Aug   
1082  14.366667         170 48       1.265789      14.135965    Tuesday   Feb   
1097   2.333333        265 265       0.753077       3.411538     Monday   Aug   
1110  58.400000        239 132      19.795000      50.562500  Wednesday   Sep   
1179  40.666667        238 132      19.470000      53.861111     Monday   Jun   

      rush\PYGZus{}hour  
11            0  
110           0  
161           0  
247           0  
379           0  
388           1  
406           0  
449           0  
468           0  
520           0  
569           0  
572           0  
586           0  
692           0  
717           0  
719           1  
782           1  
816           1  
818           1  
835           0  
840           0  
861           0  
881           0  
958           0  
970           0  
984           1  
1082          1  
1097          0  
1110          0  
1179          1  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Isolate modeling variables}

\sphinxAtStartPar
Drop features that are redundant, irrelevant, or that will not be available in a deployed environment.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 25 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype         
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}         
 0   Unnamed: 0             22699 non\PYGZhy{}null  int64         
 1   VendorID               22699 non\PYGZhy{}null  int64         
 2   tpep\PYGZus{}pickup\PYGZus{}datetime   22699 non\PYGZhy{}null  datetime64[ns]
 3   tpep\PYGZus{}dropoff\PYGZus{}datetime  22699 non\PYGZhy{}null  datetime64[ns]
 4   passenger\PYGZus{}count        22699 non\PYGZhy{}null  int64         
 5   trip\PYGZus{}distance          22699 non\PYGZhy{}null  float64       
 6   RatecodeID             22699 non\PYGZhy{}null  int64         
 7   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     22699 non\PYGZhy{}null  object        
 8   PULocationID           22699 non\PYGZhy{}null  int64         
 9   DOLocationID           22699 non\PYGZhy{}null  int64         
 10  payment\PYGZus{}type           22699 non\PYGZhy{}null  int64         
 11  fare\PYGZus{}amount            22699 non\PYGZhy{}null  float64       
 12  extra                  22699 non\PYGZhy{}null  float64       
 13  mta\PYGZus{}tax                22699 non\PYGZhy{}null  float64       
 14  tip\PYGZus{}amount             22699 non\PYGZhy{}null  float64       
 15  tolls\PYGZus{}amount           22699 non\PYGZhy{}null  float64       
 16  improvement\PYGZus{}surcharge  22699 non\PYGZhy{}null  float64       
 17  total\PYGZus{}amount           22699 non\PYGZhy{}null  float64       
 18  duration               22699 non\PYGZhy{}null  float64       
 19  pickup\PYGZus{}dropoff         22699 non\PYGZhy{}null  object        
 20  mean\PYGZus{}distance          22699 non\PYGZhy{}null  float64       
 21  mean\PYGZus{}duration          22699 non\PYGZhy{}null  float64       
 22  day                    22699 non\PYGZhy{}null  object        
 23  month                  22699 non\PYGZhy{}null  object        
 24  rush\PYGZus{}hour              22699 non\PYGZhy{}null  int64         
dtypes: datetime64[ns](2), float64(11), int64(8), object(4)
memory usage: 4.3+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{describe}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
         Unnamed: 0      VendorID           tpep\PYGZus{}pickup\PYGZus{}datetime  \PYGZbs{}
count  2.269900e+04  22699.000000                          22699   
mean   5.675849e+07      1.556236  2017\PYGZhy{}06\PYGZhy{}29 07:32:48.973126656   
min    1.212700e+04      1.000000            2017\PYGZhy{}01\PYGZhy{}01 00:08:25   
25\PYGZpc{}    2.852056e+07      1.000000     2017\PYGZhy{}03\PYGZhy{}30 03:09:38.500000   
50\PYGZpc{}    5.673150e+07      2.000000            2017\PYGZhy{}06\PYGZhy{}23 12:35:57   
75\PYGZpc{}    8.537452e+07      2.000000            2017\PYGZhy{}10\PYGZhy{}02 10:34:34   
max    1.134863e+08      2.000000            2017\PYGZhy{}12\PYGZhy{}31 23:45:30   
std    3.274493e+07      0.496838                            NaN   

               tpep\PYGZus{}dropoff\PYGZus{}datetime  passenger\PYGZus{}count  trip\PYGZus{}distance  \PYGZbs{}
count                          22699     22699.000000   22699.000000   
mean   2017\PYGZhy{}06\PYGZhy{}29 07:49:49.799726848         1.642319       2.913313   
min              2017\PYGZhy{}01\PYGZhy{}01 00:17:20         0.000000       0.000000   
25\PYGZpc{}       2017\PYGZhy{}03\PYGZhy{}30 03:11:20.500000         1.000000       0.990000   
50\PYGZpc{}              2017\PYGZhy{}06\PYGZhy{}23 12:55:11         1.000000       1.610000   
75\PYGZpc{}              2017\PYGZhy{}10\PYGZhy{}02 10:53:47         2.000000       3.060000   
max              2017\PYGZhy{}12\PYGZhy{}31 23:49:24         6.000000      33.960000   
std                              NaN         1.285231       3.653171   

         RatecodeID  PULocationID  DOLocationID  payment\PYGZus{}type   fare\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000  22699.000000   
mean       1.043394    162.412353    161.527997      1.336887     12.897913   
min        1.000000      1.000000      1.000000      1.000000      0.000000   
25\PYGZpc{}        1.000000    114.000000    112.000000      1.000000      6.500000   
50\PYGZpc{}        1.000000    162.000000    162.000000      1.000000      9.500000   
75\PYGZpc{}        1.000000    233.000000    233.000000      2.000000     14.500000   
max       99.000000    265.000000    265.000000      4.000000     62.500000   
std        0.708391     66.633373     70.139691      0.496211     10.541137   

              extra       mta\PYGZus{}tax    tip\PYGZus{}amount  tolls\PYGZus{}amount  \PYGZbs{}
count  22699.000000  22699.000000  22699.000000  22699.000000   
mean       0.333275      0.497445      1.835781      0.312542   
min       \PYGZhy{}1.000000     \PYGZhy{}0.500000      0.000000      0.000000   
25\PYGZpc{}        0.000000      0.500000      0.000000      0.000000   
50\PYGZpc{}        0.000000      0.500000      1.350000      0.000000   
75\PYGZpc{}        0.500000      0.500000      2.450000      0.000000   
max        4.500000      0.500000    200.000000     19.100000   
std        0.463097      0.039465      2.800626      1.399212   

       improvement\PYGZus{}surcharge  total\PYGZus{}amount      duration  mean\PYGZus{}distance  \PYGZbs{}
count           22699.000000  22699.000000  22699.000000   22699.000000   
mean                0.299551     16.310502     14.460555       2.913313   
min                \PYGZhy{}0.300000   \PYGZhy{}120.300000      0.000000       0.000000   
25\PYGZpc{}                 0.300000      8.750000      6.650000       1.010000   
50\PYGZpc{}                 0.300000     11.800000     11.183333       1.620000   
75\PYGZpc{}                 0.300000     17.800000     18.383333       3.115625   
max                 0.300000   1200.290000     88.783333      33.920000   
std                 0.015673     16.097295     11.947043       3.558993   

       mean\PYGZus{}duration     rush\PYGZus{}hour  
count   22699.000000  22699.000000  
mean       14.460555      0.296753  
min         0.000000      0.000000  
25\PYGZpc{}         8.031481      0.000000  
50\PYGZpc{}        11.556667      0.000000  
75\PYGZpc{}        17.321667      1.000000  
max        88.783333      1.000000  
std        10.080913      0.456837  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df2} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{copy}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{df2}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unnamed: 0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RatecodeID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PULocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOLocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{extra}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mta\PYGZus{}tax}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tolls\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{improvement\PYGZus{}surcharge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pickup\PYGZus{}dropoff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1} \PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{df2}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   VendorID  passenger\PYGZus{}count  fare\PYGZus{}amount  mean\PYGZus{}distance  mean\PYGZus{}duration  \PYGZbs{}
0         2                6         13.0       3.521667      22.847222   
1         1                1         16.0       3.108889      24.470370   
2         1                1          6.5       0.881429       7.250000   
3         2                1         20.5       3.700000      30.250000   
4         2                1         16.5       4.435000      14.616667   

   rush\PYGZus{}hour  
0          0  
1          0  
2          1  
3          0  
4          0  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Pair plot}

\sphinxAtStartPar
Create a pairplot to visualize pairwise relationships between \sphinxcode{\sphinxupquote{fare\_amount}}, \sphinxcode{\sphinxupquote{mean\_duration}}, and \sphinxcode{\sphinxupquote{mean\_distance}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a pairplot to visualize pairwise relationships between variables in the data}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{pairplot}\PYG{p}{(}\PYG{n}{df2}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]} \PYG{p}{,} \PYG{n}{markers}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}seaborn.axisgrid.PairGrid at 0x13cae7710\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{3abe6786c25d4d2ddf99398b1f1c2ac7ca85e773f1aac93abb8685b7f225d6c2}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
These variables all show linear correlation with each other. Investigate this further.


\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Identify correlations}

\sphinxAtStartPar
Next, code a correlation matrix to help determine most correlated variables.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Correlation matrix to help determine most correlated variables}
\PYG{n}{df2}\PYG{o}{.}\PYG{n}{corr}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
                 VendorID  passenger\PYGZus{}count  fare\PYGZus{}amount  mean\PYGZus{}distance  \PYGZbs{}
VendorID         1.000000         0.266463     0.001045       0.004741   
passenger\PYGZus{}count  0.266463         1.000000     0.014942       0.013428   
fare\PYGZus{}amount      0.001045         0.014942     1.000000       0.910185   
mean\PYGZus{}distance    0.004741         0.013428     0.910185       1.000000   
mean\PYGZus{}duration    0.001876         0.015852     0.859105       0.874864   
rush\PYGZus{}hour       \PYGZhy{}0.002874        \PYGZhy{}0.022035    \PYGZhy{}0.020075      \PYGZhy{}0.039725   

                 mean\PYGZus{}duration  rush\PYGZus{}hour  
VendorID              0.001876  \PYGZhy{}0.002874  
passenger\PYGZus{}count       0.015852  \PYGZhy{}0.022035  
fare\PYGZus{}amount           0.859105  \PYGZhy{}0.020075  
mean\PYGZus{}distance         0.874864  \PYGZhy{}0.039725  
mean\PYGZus{}duration         1.000000  \PYGZhy{}0.021583  
rush\PYGZus{}hour            \PYGZhy{}0.021583   1.000000  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Visualize a correlation heatmap of the data.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create correlation heatmap}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{heatmap}\PYG{p}{(}\PYG{n}{df2}\PYG{o}{.}\PYG{n}{corr}\PYG{p}{(}\PYG{p}{)} \PYG{p}{,} \PYG{n}{annot}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: \PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{138a7a0ae55a95d3ef99795cf786d1c026041ecf68c56ab438d7a46d961dca67}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Split data into outcome variable and features}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X} \PYG{o}{=} \PYG{n}{df2}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{n}{columns}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{df2}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{y}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   VendorID  passenger\PYGZus{}count  mean\PYGZus{}distance  mean\PYGZus{}duration  rush\PYGZus{}hour
0         2                6       3.521667      22.847222          0
1         1                1       3.108889      24.470370          0
2         1                1       0.881429       7.250000          1
3         2                1       3.700000      30.250000          0
4         2                1       4.435000      14.616667          0

   fare\PYGZus{}amount
0         13.0
1         16.0
2          6.5
3         20.5
4         16.5
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Set your X and y variables. X represents the features and y represents the outcome (target) variable.


\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Pre\sphinxhyphen{}process data}

\sphinxAtStartPar
Dummy encode categorical variables

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Convert VendorID to string}
\PYG{n}{X}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VendorID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{X}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VendorID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Get dummies}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{get\PYGZus{}dummies}\PYG{p}{(}\PYG{n}{X} \PYG{p}{,} \PYG{n}{drop\PYGZus{}first}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   passenger\PYGZus{}count  mean\PYGZus{}distance  mean\PYGZus{}duration  rush\PYGZus{}hour  VendorID\PYGZus{}2
0                6       3.521667      22.847222          0        True
1                1       3.108889      24.470370          0       False
2                1       0.881429       7.250000          1       False
3                1       3.700000      30.250000          0        True
4                1       4.435000      14.616667          0        True
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Split data into training and test sets}

\sphinxAtStartPar
Create training and testing sets. The test set should contain 20\% of the total samples. Set \sphinxcode{\sphinxupquote{random\_state=0}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create training and testing sets}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{} YOUR CODE HERE \PYGZsh{}\PYGZsh{}\PYGZsh{}\PYGZsh{}}

\PYG{n}{X\PYGZus{}train} \PYG{p}{,} \PYG{n}{X\PYGZus{}test} \PYG{p}{,} \PYG{n}{y\PYGZus{}train} \PYG{p}{,} \PYG{n}{y\PYGZus{}test} \PYG{o}{=} \PYG{n}{train\PYGZus{}test\PYGZus{}split}\PYG{p}{(}\PYG{n}{X} \PYG{p}{,} \PYG{n}{y} \PYG{p}{,} \PYG{n}{test\PYGZus{}size}\PYG{o}{=}\PYG{l+m+mf}{0.2} \PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Standardize the data}

\sphinxAtStartPar
Use \sphinxcode{\sphinxupquote{StandardScaler()}}, \sphinxcode{\sphinxupquote{fit()}}, and \sphinxcode{\sphinxupquote{transform()}} to standardize the \sphinxcode{\sphinxupquote{X\_train}} variables. Assign the results to a variable called \sphinxcode{\sphinxupquote{X\_train\_scaled}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Standardize the X variables}
\PYG{n}{scaler} \PYG{o}{=} \PYG{n}{StandardScaler}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train}\PYG{p}{)}
\PYG{n}{X\PYGZus{}train\PYGZus{}scaled} \PYG{o}{=} \PYG{n}{scaler}\PYG{o}{.}\PYG{n}{transform}\PYG{p}{(}\PYG{n}{X\PYGZus{}train}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X\PYGZus{}train\PYGZus{}scaled}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
array([[\PYGZhy{}0.50301524,  0.8694684 ,  0.17616665, \PYGZhy{}0.64893329,  0.89286563],
       [\PYGZhy{}0.50301524, \PYGZhy{}0.60011281, \PYGZhy{}0.69829589,  1.54099045,  0.89286563],
       [ 0.27331093, \PYGZhy{}0.47829156, \PYGZhy{}0.57301906, \PYGZhy{}0.64893329, \PYGZhy{}1.11998936],
       ...,
       [\PYGZhy{}0.50301524, \PYGZhy{}0.45121122, \PYGZhy{}0.6788917 , \PYGZhy{}0.64893329, \PYGZhy{}1.11998936],
       [\PYGZhy{}0.50301524, \PYGZhy{}0.58944763, \PYGZhy{}0.85743597,  1.54099045, \PYGZhy{}1.11998936],
       [ 1.82596329,  0.83673851,  1.13212101, \PYGZhy{}0.64893329,  0.89286563]])
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\section{Model Estimation}
\label{\detokenize{Automatidata_Regression Analysis:model-estimation}}
\sphinxAtStartPar
Instantiate your model and fit it to the training data.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Fit your model to the training data}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{LinearRegression}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{model}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train\PYGZus{}scaled} \PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
LinearRegression()
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Evaluate model}

\sphinxAtStartPar
\sphinxstylestrong{Train data}

\sphinxAtStartPar
Evaluate your model performance by calculating the residual sum of squares and the explained variance score (R\textasciicircum{}2). Calculate the Mean Absolute Error, Mean Squared Error, and the Root Mean Squared Error.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{y\PYGZus{}pred\PYGZus{}train} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X\PYGZus{}train\PYGZus{}scaled}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Evaluate the model performance on the training data}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{R\PYGZhy{}squared}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{model}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{X\PYGZus{}train\PYGZus{}scaled}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MAE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{mean\PYGZus{}absolute\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}train} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}train}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MSE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{mean\PYGZus{}squared\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}train} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}train}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RMSE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{mean\PYGZus{}squared\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}train} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}train}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
R\PYGZhy{}squared 0.8398434585044773
MAE 2.1866664167754157
MSE 17.88973296349268
RMSE 4.229625629236313
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip


\sphinxAtStartPar
\sphinxstylestrong{Test data}

\sphinxAtStartPar
Calculate the same metrics on the test data. Remember to scale the \sphinxcode{\sphinxupquote{X\_test}} data using the scaler that was fit to the training data. Do not refit the scaler to the testing data, just transform it. Call the results \sphinxcode{\sphinxupquote{X\_test\_scaled}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X\PYGZus{}test\PYGZus{}scaled} \PYG{o}{=} \PYG{n}{scaler}\PYG{o}{.}\PYG{n}{transform}\PYG{p}{(}\PYG{n}{X\PYGZus{}test}\PYG{p}{)}
\PYG{n}{y\PYGZus{}pred\PYGZus{}test} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X\PYGZus{}test\PYGZus{}scaled}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Scale the X\PYGZus{}test data}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}test\PYGZus{}scaled} \PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
LinearRegression()
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Evaluate the model performance on the testing data}
\PYG{n}{y\PYGZus{}pred\PYGZus{}test} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X\PYGZus{}test\PYGZus{}scaled}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{R\PYGZhy{}squared}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{model}\PYG{o}{.}\PYG{n}{score}\PYG{p}{(}\PYG{n}{X\PYGZus{}test\PYGZus{}scaled} \PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MAE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{mean\PYGZus{}absolute\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}test} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}test}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MSE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{mean\PYGZus{}squared\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}test} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}test}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RMSE}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{mean\PYGZus{}squared\PYGZus{}error}\PYG{p}{(}\PYG{n}{y\PYGZus{}test} \PYG{p}{,} \PYG{n}{y\PYGZus{}pred\PYGZus{}test}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
R\PYGZhy{}squared 0.8688418048100106
MAE 2.1126188601915166
MSE 14.263006975751834
RMSE 3.7766396407059855
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\bigskip\hrule\bigskip



\section{Results}
\label{\detokenize{Automatidata_Regression Analysis:results}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a `results` dataframe}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{y\PYGZus{}test}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                      \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{y\PYGZus{}pred\PYGZus{}test}\PYG{o}{.}\PYG{n}{ravel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{results}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       actual  predicted   residual
5818     14.0  12.346025   1.653975
18134    28.0  16.365952  11.634048
4655      5.5   6.587892  \PYGZhy{}1.087892
7378     15.5  16.309853  \PYGZhy{}0.809853
13914     9.5  10.291103  \PYGZhy{}0.791103
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a scatterplot to visualize `predicted` over `actual`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{scatterplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}predicted\PYGZsq{}, ylabel=\PYGZsq{}actual\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{2f9fe9a9a7fb34d89d4e8011e125658c213b2e169c7328bec4c6a52ec17c34fb}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Visualize the distribution of the `residuals`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{kde}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}residual\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{533941d622b294dbe15352a287ea762234d34b2ece98049ff8a4f244f1afa701}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Calculate residual mean}
\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
7.762757641784354e\PYGZhy{}16
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a scatterplot of `residuals` over `predicted`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{regplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}predicted\PYGZsq{}, ylabel=\PYGZsq{}residual\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{577d7a2f9e159ce4632ec92f1331dbed379cc726ba9b66ceef32922317830dd0}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 5 columns):
 \PYGZsh{}   Column           Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}           \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   passenger\PYGZus{}count  22699 non\PYGZhy{}null  int64  
 1   mean\PYGZus{}distance    22699 non\PYGZhy{}null  float64
 2   mean\PYGZus{}duration    22699 non\PYGZhy{}null  float64
 3   rush\PYGZus{}hour        22699 non\PYGZhy{}null  int64  
 4   VendorID\PYGZus{}2       22699 non\PYGZhy{}null  bool   
dtypes: bool(1), float64(2), int64(2)
memory usage: 731.6 KB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a `results` dataframe}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{y\PYGZus{}test}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                      \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{n}{y\PYGZus{}pred\PYGZus{}test}\PYG{o}{.}\PYG{n}{ravel}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{results}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       actual  predicted   residual
5818     14.0  12.346025   1.653975
18134    28.0  16.365952  11.634048
4655      5.5   6.587892  \PYGZhy{}1.087892
7378     15.5  16.309853  \PYGZhy{}0.809853
13914     9.5  10.291103  \PYGZhy{}0.791103
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Visualize Model Results}
\label{\detokenize{Automatidata_Regression Analysis:visualize-model-results}}
\sphinxAtStartPar
Create a scatterplot to visualize \sphinxcode{\sphinxupquote{actual}} vs. \sphinxcode{\sphinxupquote{predicted}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a scatterplot to visualize `predicted` over `actual`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{scatterplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{actual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}predicted\PYGZsq{}, ylabel=\PYGZsq{}actual\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{2f9fe9a9a7fb34d89d4e8011e125658c213b2e169c7328bec4c6a52ec17c34fb}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Visualize the distribution of the \sphinxcode{\sphinxupquote{residuals}} using a histogram.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Visualize the distribution of the `residuals`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{histplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{kde}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}residual\PYGZsq{}, ylabel=\PYGZsq{}Count\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{533941d622b294dbe15352a287ea762234d34b2ece98049ff8a4f244f1afa701}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Calculate residual mean}
\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
7.762757641784354e\PYGZhy{}16
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Create a scatterplot of \sphinxcode{\sphinxupquote{residuals}} over \sphinxcode{\sphinxupquote{predicted}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a scatterplot of `residuals` over `predicted`}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{regplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{results} \PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{predicted}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{residual}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}Axes: xlabel=\PYGZsq{}predicted\PYGZsq{}, ylabel=\PYGZsq{}residual\PYGZsq{}\PYGZgt{}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{a56ddf2780f32eec6cc87b4dbd58605ef6a240d1969267a974e754ab9f418c80}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Coefficients}
\label{\detokenize{Automatidata_Regression Analysis:coefficients}}
\sphinxAtStartPar
Use the \sphinxcode{\sphinxupquote{coef\_}} attribute to get the model’s coefficients. The coefficients are output in the order of the features that were used to train the model. Which feature had the greatest effect on trip fare?

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 5 columns):
 \PYGZsh{}   Column           Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}           \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   passenger\PYGZus{}count  22699 non\PYGZhy{}null  int64  
 1   mean\PYGZus{}distance    22699 non\PYGZhy{}null  float64
 2   mean\PYGZus{}duration    22699 non\PYGZhy{}null  float64
 3   rush\PYGZus{}hour        22699 non\PYGZhy{}null  int64  
 4   VendorID\PYGZus{}2       22699 non\PYGZhy{}null  bool   
dtypes: bool(1), float64(2), int64(2)
memory usage: 731.6 KB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Output the model\PYGZsq{}s coefficients}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
array([[0.02196379, 7.32092374, 2.84139502, 0.22159236, 0.03474851]])
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{model}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{o}{.}\PYG{n}{flatten}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
5
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coefficients} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coefficients}\PYG{o}{.}\PYG{n}{shape}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(0, 5)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{coefficients}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coefficients}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{o}{.}\PYG{n}{flatten}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coefficients}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   passenger\PYGZus{}count  mean\PYGZus{}distance  mean\PYGZus{}duration  rush\PYGZus{}hour  VendorID\PYGZus{}2
1         0.021964       7.320924       2.841395   0.221592    0.034749
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxstepscope


\chapter{Machine Learning}
\label{\detokenize{Automatidata_Machine Learning:machine-learning}}\label{\detokenize{Automatidata_Machine Learning::doc}}
\sphinxAtStartPar
You are a data professional in a data analytics firm called Automatidata. Their client, the New York City Taxi \& Limousine Commission (New York City TLC), was impressed with the work you have done and has requested that you build a machine learning model to predict if a customer will not leave a tip. They want to use the model in an app that will alert taxi drivers to customers who are unlikely to tip, since drivers depend on tips.

\sphinxAtStartPar
A notebook was structured and prepared to help you in this project. Please complete the following questions.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Import packages and libraries}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{from} \PYG{n+nn}{matplotlib} \PYG{k+kn}{import} \PYG{n}{pyplot} \PYG{k}{as} \PYG{n}{plt}

\PYG{k+kn}{from} \PYG{n+nn}{xgboost} \PYG{k+kn}{import} \PYG{n}{XGBClassifier}\PYG{p}{,}\PYG{n}{plot\PYGZus{}importance}

\PYG{k+kn}{from} \PYG{n+nn}{sklearn} \PYG{k+kn}{import} \PYG{n}{metrics}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{model\PYGZus{}selection} \PYG{k+kn}{import} \PYG{n}{GridSearchCV}\PYG{p}{,}\PYG{n}{train\PYGZus{}test\PYGZus{}split}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{ensemble} \PYG{k+kn}{import} \PYG{n}{RandomForestClassifier}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} This lets us see all of the columns, preventing Juptyer from redacting them.}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{set\PYGZus{}option}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{display.max\PYGZus{}columns}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{k+kc}{None}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Load dataset into dataframe}
\PYG{n}{df0} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2017\PYGZus{}Yellow\PYGZus{}Taxi\PYGZus{}Trip\PYGZus{}Data.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Import predicted fares and mean distance and duration from previous course}
\PYG{n}{nyc\PYGZus{}preds\PYGZus{}means} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nyc\PYGZus{}preds\PYGZus{}means.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{df0}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID    tpep\PYGZus{}pickup\PYGZus{}datetime   tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2   03/25/2017 8:55:43 AM   03/25/2017 9:09:47 AM   
1    35634249         1   04/11/2017 2:53:28 PM   04/11/2017 3:19:58 PM   
2   106203690         1   12/15/2017 7:26:56 AM   12/15/2017 7:34:08 AM   
3    38942136         2   05/07/2017 1:17:59 PM   05/07/2017 1:48:14 PM   
4    30841670         2  04/15/2017 11:32:20 PM  04/15/2017 11:49:03 PM   
5    23345809         2   03/25/2017 8:34:11 PM   03/25/2017 8:42:11 PM   
6    37660487         2   05/03/2017 7:04:09 PM   05/03/2017 8:03:47 PM   
7    69059411         2   08/15/2017 5:41:06 PM   08/15/2017 6:03:05 PM   
8     8433159         2   02/04/2017 4:17:07 PM   02/04/2017 4:29:14 PM   
9    95294817         1   11/10/2017 3:20:29 PM   11/10/2017 3:40:55 PM   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   
1                1           1.80           1                  N   
2                1           1.00           1                  N   
3                1           3.70           1                  N   
4                1           4.37           1                  N   
5                6           2.30           1                  N   
6                1          12.83           1                  N   
7                1           2.98           1                  N   
8                1           1.20           1                  N   
9                1           1.60           1                  N   

   PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0           100           231             1         13.0    0.0      0.5   
1           186            43             1         16.0    0.0      0.5   
2           262           236             1          6.5    0.0      0.5   
3           188            97             1         20.5    0.0      0.5   
4             4           112             2         16.5    0.5      0.5   
5           161           236             1          9.0    0.5      0.5   
6            79           241             1         47.5    1.0      0.5   
7           237           114             1         16.0    1.0      0.5   
8           234           249             2          9.0    0.0      0.5   
9           239           237             1         13.0    0.0      0.5   

   tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  
0        2.76           0.0                    0.3         16.56  
1        4.00           0.0                    0.3         20.80  
2        1.45           0.0                    0.3          8.75  
3        6.39           0.0                    0.3         27.69  
4        0.00           0.0                    0.3         17.80  
5        2.06           0.0                    0.3         12.36  
6        9.86           0.0                    0.3         59.16  
7        1.78           0.0                    0.3         19.58  
8        0.00           0.0                    0.3          9.80  
9        2.75           0.0                    0.3         16.55  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{nyc\PYGZus{}preds\PYGZus{}means}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   mean\PYGZus{}duration  mean\PYGZus{}distance  predicted\PYGZus{}fare
0      22.847222       3.521667       16.434245
1      24.470370       3.108889       16.052218
2       7.250000       0.881429        7.053706
3      30.250000       3.700000       18.731650
4      14.616667       4.435000       15.845642
5      11.855376       2.052258       10.441351
6      59.633333      12.830000       45.374542
7      26.437500       4.022500       18.555128
8       7.873457       1.019259        7.151511
9      10.541111       1.580000        9.122755
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Join the two dataframes}

\sphinxAtStartPar
Join the two dataframes using a method of your choice.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Merge datasets}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{} YOUR CODE HERE \PYGZsh{}\PYGZsh{}\PYGZsh{}}
\PYG{n}{df0} \PYG{o}{=} \PYG{n}{df0}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{nyc\PYGZus{}preds\PYGZus{}means}\PYG{p}{,}\PYG{n}{left\PYGZus{}index}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{right\PYGZus{}index}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df0}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
       Unnamed: 0  VendorID    tpep\PYGZus{}pickup\PYGZus{}datetime   tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0        24870114         2   03/25/2017 8:55:43 AM   03/25/2017 9:09:47 AM   
1        35634249         1   04/11/2017 2:53:28 PM   04/11/2017 3:19:58 PM   
2       106203690         1   12/15/2017 7:26:56 AM   12/15/2017 7:34:08 AM   
3        38942136         2   05/07/2017 1:17:59 PM   05/07/2017 1:48:14 PM   
4        30841670         2  04/15/2017 11:32:20 PM  04/15/2017 11:49:03 PM   
...           ...       ...                     ...                     ...   
22694    14873857         2   02/24/2017 5:37:23 PM   02/24/2017 5:40:39 PM   
22695    66632549         2   08/06/2017 4:43:59 PM   08/06/2017 5:24:47 PM   
22696    74239933         2   09/04/2017 2:54:14 PM   09/04/2017 2:58:22 PM   
22697    60217333         2  07/15/2017 12:56:30 PM   07/15/2017 1:08:26 PM   
22698    17208911         1   03/02/2017 1:02:49 PM   03/02/2017 1:16:09 PM   

       passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                    6           3.34           1                  N   
1                    1           1.80           1                  N   
2                    1           1.00           1                  N   
3                    1           3.70           1                  N   
4                    1           4.37           1                  N   
...                ...            ...         ...                ...   
22694                3           0.61           1                  N   
22695                1          16.71           2                  N   
22696                1           0.42           1                  N   
22697                1           2.36           1                  N   
22698                1           2.10           1                  N   

       PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0               100           231             1         13.0    0.0      0.5   
1               186            43             1         16.0    0.0      0.5   
2               262           236             1          6.5    0.0      0.5   
3               188            97             1         20.5    0.0      0.5   
4                 4           112             2         16.5    0.5      0.5   
...             ...           ...           ...          ...    ...      ...   
22694            48           186             2          4.0    1.0      0.5   
22695           132           164             1         52.0    0.0      0.5   
22696           107           234             2          4.5    0.0      0.5   
22697            68           144             1         10.5    0.0      0.5   
22698           239           236             1         11.0    0.0      0.5   

       tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  \PYGZbs{}
0            2.76          0.00                    0.3         16.56   
1            4.00          0.00                    0.3         20.80   
2            1.45          0.00                    0.3          8.75   
3            6.39          0.00                    0.3         27.69   
4            0.00          0.00                    0.3         17.80   
...           ...           ...                    ...           ...   
22694        0.00          0.00                    0.3          5.80   
22695       14.64          5.76                    0.3         73.20   
22696        0.00          0.00                    0.3          5.30   
22697        1.70          0.00                    0.3         13.00   
22698        2.35          0.00                    0.3         14.15   

       mean\PYGZus{}duration  mean\PYGZus{}distance  predicted\PYGZus{}fare  
0          22.847222       3.521667       16.434245  
1          24.470370       3.108889       16.052218  
2           7.250000       0.881429        7.053706  
3          30.250000       3.700000       18.731650  
4          14.616667       4.435000       15.845642  
...              ...            ...             ...  
22694       8.594643       1.098214        7.799138  
22695      59.560417      18.757500       52.000000  
22696       6.609091       0.684242        6.130896  
22697      16.650000       2.077500       11.707049  
22698       9.405556       1.476970        8.600969  

[22699 rows x 21 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\section{Feature engineering}
\label{\detokenize{Automatidata_Machine Learning:feature-engineering}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df0}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
RangeIndex: 22699 entries, 0 to 22698
Data columns (total 21 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   Unnamed: 0             22699 non\PYGZhy{}null  int64  
 1   VendorID               22699 non\PYGZhy{}null  int64  
 2   tpep\PYGZus{}pickup\PYGZus{}datetime   22699 non\PYGZhy{}null  object 
 3   tpep\PYGZus{}dropoff\PYGZus{}datetime  22699 non\PYGZhy{}null  object 
 4   passenger\PYGZus{}count        22699 non\PYGZhy{}null  int64  
 5   trip\PYGZus{}distance          22699 non\PYGZhy{}null  float64
 6   RatecodeID             22699 non\PYGZhy{}null  int64  
 7   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     22699 non\PYGZhy{}null  object 
 8   PULocationID           22699 non\PYGZhy{}null  int64  
 9   DOLocationID           22699 non\PYGZhy{}null  int64  
 10  payment\PYGZus{}type           22699 non\PYGZhy{}null  int64  
 11  fare\PYGZus{}amount            22699 non\PYGZhy{}null  float64
 12  extra                  22699 non\PYGZhy{}null  float64
 13  mta\PYGZus{}tax                22699 non\PYGZhy{}null  float64
 14  tip\PYGZus{}amount             22699 non\PYGZhy{}null  float64
 15  tolls\PYGZus{}amount           22699 non\PYGZhy{}null  float64
 16  improvement\PYGZus{}surcharge  22699 non\PYGZhy{}null  float64
 17  total\PYGZus{}amount           22699 non\PYGZhy{}null  float64
 18  mean\PYGZus{}duration          22699 non\PYGZhy{}null  float64
 19  mean\PYGZus{}distance          22699 non\PYGZhy{}null  float64
 20  predicted\PYGZus{}fare         22699 non\PYGZhy{}null  float64
dtypes: float64(11), int64(7), object(3)
memory usage: 3.6+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df0}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID    tpep\PYGZus{}pickup\PYGZus{}datetime   tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2   03/25/2017 8:55:43 AM   03/25/2017 9:09:47 AM   
1    35634249         1   04/11/2017 2:53:28 PM   04/11/2017 3:19:58 PM   
2   106203690         1   12/15/2017 7:26:56 AM   12/15/2017 7:34:08 AM   
3    38942136         2   05/07/2017 1:17:59 PM   05/07/2017 1:48:14 PM   
4    30841670         2  04/15/2017 11:32:20 PM  04/15/2017 11:49:03 PM   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   
1                1           1.80           1                  N   
2                1           1.00           1                  N   
3                1           3.70           1                  N   
4                1           4.37           1                  N   

   PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0           100           231             1         13.0    0.0      0.5   
1           186            43             1         16.0    0.0      0.5   
2           262           236             1          6.5    0.0      0.5   
3           188            97             1         20.5    0.0      0.5   
4             4           112             2         16.5    0.5      0.5   

   tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  \PYGZbs{}
0        2.76           0.0                    0.3         16.56   
1        4.00           0.0                    0.3         20.80   
2        1.45           0.0                    0.3          8.75   
3        6.39           0.0                    0.3         27.69   
4        0.00           0.0                    0.3         17.80   

   mean\PYGZus{}duration  mean\PYGZus{}distance  predicted\PYGZus{}fare  
0      22.847222       3.521667       16.434245  
1      24.470370       3.108889       16.052218  
2       7.250000       0.881429        7.053706  
3      30.250000       3.700000       18.731650  
4      14.616667       4.435000       15.845642  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Subset the data to isolate only customers who paid by credit card}
\PYG{n}{df1} \PYG{o}{=} \PYG{n}{df0}\PYG{p}{[}\PYG{n}{df0}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{\sphinxstylestrong{Target}}
\label{\detokenize{Automatidata_Machine Learning:target}}
\sphinxAtStartPar
Notice that there isn’t a column that indicates tip percent, which is what you need to create the target variable. You’ll have to engineer it.

\sphinxAtStartPar
Add a \sphinxcode{\sphinxupquote{tip\_percent}} column to the dataframe by performing the following calculation:\\

\begin{equation*}
\begin{split}tip\ percent = \frac{tip\ amount}{total\ amount - tip\ amount}\end{split}
\end{equation*}
\sphinxAtStartPar
Round the result to three places beyond the decimal. \sphinxstylestrong{This is an important step.} It affects how many customers are labeled as generous tippers. In fact, without performing this step, approximately 1,800 people who do tip ≥ 20\% would be labeled as not generous.

\sphinxAtStartPar
To understand why, you must consider how floats work. Computers make their calculations using floating\sphinxhyphen{}point arithmetic (hence the word “float”). Floating\sphinxhyphen{}point arithmetic is a system that allows computers to express both very large numbers and very small numbers with a high degree of precision, encoded in binary. However, precision is limited by the number of bits used to represent a number, which is generally 32 or 64, depending on the capabilities of your operating system.

\sphinxAtStartPar
This comes with limitations in that sometimes calculations that should result in clean, precise values end up being encoded as very long decimals. Take, for example, the following calculation:

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Run this cell}
\PYG{l+m+mf}{1.1} \PYG{o}{+} \PYG{l+m+mf}{2.2}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
3.3000000000000003
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Notice the three that is 16 places to the right of the decimal. As a consequence, if you were to then have a step in your code that identifies values ≤ 3.3, this would not be included in the result. Therefore, whenever you perform a calculation to compute a number that is then used to make an important decision or filtration, round the number. How many degrees of precision you round to is your decision, which should be based on your use case.

\sphinxAtStartPar
Refer to this \sphinxhref{https://floating-point-gui.de/formats/fp/}{guide for more information related to floating\sphinxhyphen{}point arithmetic}.\\
Refer to this \sphinxhref{https://inst.eecs.berkeley.edu/~cs61c/sp06/handout/fixedpt.html}{guide for more information related to fixed\sphinxhyphen{}point arithmetic}, which is an alternative to floating\sphinxhyphen{}point arithmetic used in certain cases.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID   tpep\PYGZus{}pickup\PYGZus{}datetime  tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2  03/25/2017 8:55:43 AM  03/25/2017 9:09:47 AM   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   

   PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0           100           231             1         13.0    0.0      0.5   

   tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  \PYGZbs{}
0        2.76           0.0                    0.3         16.56   

   mean\PYGZus{}duration  mean\PYGZus{}distance  predicted\PYGZus{}fare  
0      22.847222       3.521667       16.434245  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{100} \PYG{o}{*} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{/} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0        14.29
1        16.13
2        14.22
3        18.75
5        14.29
         ...  
22692    14.26
22693    14.29
22695    16.67
22697    11.56
22698    14.24
Length: 15265, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create tip \PYGZpc{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{/} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/1025802444.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}tip\PYGZus{}percent\PYGZsq{}] = round(df1[\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}] / (df1[\PYGZsq{}total\PYGZus{}amount\PYGZsq{}] \PYGZhy{} df1[\PYGZsq{}tip\PYGZus{}amount\PYGZsq{}]), 3)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now create another column called \sphinxcode{\sphinxupquote{generous}}. This will be the target variable. The column should be a binary indicator of whether or not a customer tipped ≥ 20\% (0=no, 1=yes).
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Begin by making the \sphinxcode{\sphinxupquote{generous}} column a copy of the \sphinxcode{\sphinxupquote{tip\_percent}} column.

\item {} 
\sphinxAtStartPar
Reassign the column by converting it to Boolean (True/False).

\item {} 
\sphinxAtStartPar
Reassign the column by converting Boolean to binary (1/0).

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}generous\PYGZsq{} col (target)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mf}{0.2}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/53023181.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}generous\PYGZsq{}] = df1[\PYGZsq{}tip\PYGZus{}percent\PYGZsq{}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/53023181.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}generous\PYGZsq{}] = (df1[\PYGZsq{}generous\PYGZsq{}] \PYGZgt{}= 0.2)
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/53023181.py:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}generous\PYGZsq{}] = df1[\PYGZsq{}generous\PYGZsq{}].astype(int)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Create day column}
\label{\detokenize{Automatidata_Machine Learning:create-day-column}}
\sphinxAtStartPar
Next, you’re going to be working with the pickup and dropoff columns.

\sphinxAtStartPar
Convert the \sphinxcode{\sphinxupquote{tpep\_pickup\_datetime}} and \sphinxcode{\sphinxupquote{tpep\_dropoff\_datetime}} columns to datetime.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Convert pickup and dropoff cols to datetime}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m/}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{I:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m/}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{I:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{p}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/3830057672.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}] = pd.to\PYGZus{}datetime(df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}], format=\PYGZsq{}\PYGZpc{}m/\PYGZpc{}d/\PYGZpc{}Y \PYGZpc{}I:\PYGZpc{}M:\PYGZpc{}S \PYGZpc{}p\PYGZsq{})
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/3830057672.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}tpep\PYGZus{}dropoff\PYGZus{}datetime\PYGZsq{}] = pd.to\PYGZus{}datetime(df1[\PYGZsq{}tpep\PYGZus{}dropoff\PYGZus{}datetime\PYGZsq{}], format=\PYGZsq{}\PYGZpc{}m/\PYGZpc{}d/\PYGZpc{}Y \PYGZpc{}I:\PYGZpc{}M:\PYGZpc{}S \PYGZpc{}p\PYGZsq{})
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Create a \sphinxcode{\sphinxupquote{day}} column that contains only the day of the week when each passenger was picked up. Then, convert the values to lowercase.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create a \PYGZsq{}day\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{day}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{day\PYGZus{}name}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{str}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/918047604.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}day\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.day\PYGZus{}name().str.lower()
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Create time of day columns}
\label{\detokenize{Automatidata_Machine Learning:create-time-of-day-columns}}
\sphinxAtStartPar
Next, engineer four new columns that represent time of day bins. Each column should contain binary values (0=no, 1=yes) that indicate whether a trip began (picked up) during the following times:

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{am\_rush}} = {[}06:00\textendash{}10:00)\\
\sphinxcode{\sphinxupquote{daytime}} = {[}10:00\textendash{}16:00)\\
\sphinxcode{\sphinxupquote{pm\_rush}} = {[}16:00\textendash{}20:00)\\
\sphinxcode{\sphinxupquote{nighttime}} = {[}20:00\textendash{}06:00)

\sphinxAtStartPar
To do this, first create the four columns. For now, each new column should be identical and contain the same information: the hour (only) from the \sphinxcode{\sphinxupquote{tpep\_pickup\_datetime}} column.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}am\PYGZus{}rush\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{am\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{hour}

\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}daytime\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{daytime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{hour}

\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}pm\PYGZus{}rush\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pm\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{hour}

\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}nighttime\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nighttime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{hour}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/986325379.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}am\PYGZus{}rush\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.hour
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/986325379.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}daytime\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.hour
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/986325379.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}pm\PYGZus{}rush\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.hour
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/986325379.py:11: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}nighttime\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.hour
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
You’ll need to write four functions to convert each new column to binary (0/1). Begin with \sphinxcode{\sphinxupquote{am\_rush}}. Complete the function so if the hour is between {[}06:00\textendash{}10:00), it returns 1, otherwise, it returns 0.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Define \PYGZsq{}am\PYGZus{}rush()\PYGZsq{} conversion function [06:00\textendash{}10:00)}
\PYG{k}{def} \PYG{n+nf}{am\PYGZus{}rush}\PYG{p}{(}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{l+m+mi}{6} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{am\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{10}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{val}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now, apply the \sphinxcode{\sphinxupquote{am\_rush()}} function to the \sphinxcode{\sphinxupquote{am\_rush}} series to perform the conversion. Print the first five values of the column to make sure it did what you expected it to do.

\sphinxAtStartPar
\sphinxstylestrong{Note:} Be careful! If you run this cell twice, the function will be reapplied and the values will all be changed to 0.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Apply \PYGZsq{}am\PYGZus{}rush\PYGZsq{} function to the \PYGZsq{}am\PYGZus{}rush\PYGZsq{} series}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{am\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{am\PYGZus{}rush}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{am\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/227023620.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}am\PYGZus{}rush\PYGZsq{}] = df1.apply(am\PYGZus{}rush, axis=1)
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
0    1
1    0
2    1
3    0
5    0
Name: am\PYGZus{}rush, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now, apply the \sphinxcode{\sphinxupquote{am\_rush()}} function to the \sphinxcode{\sphinxupquote{am\_rush}} series to perform the conversion. Print the first five values of the column to make sure it did what you expected it to do.

\sphinxAtStartPar
\sphinxstylestrong{Note:} Be careful! If you run this cell twice, the function will be reapplied and the values will all be changed to 0.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Define \PYGZsq{}daytime()\PYGZsq{} conversion function [10:00\textendash{}16:00)}
\PYG{k}{def} \PYG{n+nf}{daytime}\PYG{p}{(}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{l+m+mi}{10} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{daytime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{16}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{val}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Apply \PYGZsq{}daytime\PYGZsq{} function to the \PYGZsq{}daytime\PYGZsq{} series}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{daytime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{daytime}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/1985778239.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}daytime\PYGZsq{}] = df1.apply(daytime, axis=1)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Define \PYGZsq{}pm\PYGZus{}rush()\PYGZsq{} conversion function [16:00\textendash{}20:00)}
\PYG{k}{def} \PYG{n+nf}{pm\PYGZus{}rush}\PYG{p}{(}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{l+m+mi}{16} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pm\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{20}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{val}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Apply \PYGZsq{}pm\PYGZus{}rush\PYGZsq{} function to the \PYGZsq{}pm\PYGZus{}rush\PYGZsq{} series}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pm\PYGZus{}rush}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{pm\PYGZus{}rush}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/3651034778.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}pm\PYGZus{}rush\PYGZsq{}] = df1.apply(pm\PYGZus{}rush, axis=1)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Define \PYGZsq{}nighttime()\PYGZsq{} conversion function [20:00\textendash{}06:00)}
\PYG{k}{def} \PYG{n+nf}{nighttime}\PYG{p}{(}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{l+m+mi}{20} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nighttime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{24}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{elif} \PYG{l+m+mi}{0} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{hour}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nighttime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{6}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{k}{return} \PYG{n}{val}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Apply \PYGZsq{}nighttime\PYGZsq{} function to the \PYGZsq{}nighttime\PYGZsq{} series}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nighttime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{n}{nighttime}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/230608774.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}nighttime\PYGZsq{}] = df1.apply(nighttime, axis=1)
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Create month column}
\label{\detokenize{Automatidata_Machine Learning:create-month-column}}
\sphinxAtStartPar
Now, create a \sphinxcode{\sphinxupquote{month}} column that contains only the abbreviated name of the month when each passenger was picked up, then convert the result to lowercase.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create \PYGZsq{}month\PYGZsq{} col}
\PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{str}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/var/folders/9f/pv1nlhw528d\PYGZus{}5zttzbkb\PYGZus{}h5m0000gn/T/ipykernel\PYGZus{}70614/2202272965.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row\PYGZus{}indexer,col\PYGZus{}indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas\PYGZhy{}docs/stable/user\PYGZus{}guide/indexing.html\PYGZsh{}returning\PYGZhy{}a\PYGZhy{}view\PYGZhy{}versus\PYGZhy{}a\PYGZhy{}copy
  df1[\PYGZsq{}month\PYGZsq{}] = df1[\PYGZsq{}tpep\PYGZus{}pickup\PYGZus{}datetime\PYGZsq{}].dt.strftime(\PYGZsq{}\PYGZpc{}b\PYGZsq{}).str.lower()
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Examine the first five rows of your dataframe.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   Unnamed: 0  VendorID tpep\PYGZus{}pickup\PYGZus{}datetime tpep\PYGZus{}dropoff\PYGZus{}datetime  \PYGZbs{}
0    24870114         2  2017\PYGZhy{}03\PYGZhy{}25 08:55:43   2017\PYGZhy{}03\PYGZhy{}25 09:09:47   
1    35634249         1  2017\PYGZhy{}04\PYGZhy{}11 14:53:28   2017\PYGZhy{}04\PYGZhy{}11 15:19:58   
2   106203690         1  2017\PYGZhy{}12\PYGZhy{}15 07:26:56   2017\PYGZhy{}12\PYGZhy{}15 07:34:08   
3    38942136         2  2017\PYGZhy{}05\PYGZhy{}07 13:17:59   2017\PYGZhy{}05\PYGZhy{}07 13:48:14   
5    23345809         2  2017\PYGZhy{}03\PYGZhy{}25 20:34:11   2017\PYGZhy{}03\PYGZhy{}25 20:42:11   

   passenger\PYGZus{}count  trip\PYGZus{}distance  RatecodeID store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag  \PYGZbs{}
0                6           3.34           1                  N   
1                1           1.80           1                  N   
2                1           1.00           1                  N   
3                1           3.70           1                  N   
5                6           2.30           1                  N   

   PULocationID  DOLocationID  payment\PYGZus{}type  fare\PYGZus{}amount  extra  mta\PYGZus{}tax  \PYGZbs{}
0           100           231             1         13.0    0.0      0.5   
1           186            43             1         16.0    0.0      0.5   
2           262           236             1          6.5    0.0      0.5   
3           188            97             1         20.5    0.0      0.5   
5           161           236             1          9.0    0.5      0.5   

   tip\PYGZus{}amount  tolls\PYGZus{}amount  improvement\PYGZus{}surcharge  total\PYGZus{}amount  \PYGZbs{}
0        2.76           0.0                    0.3         16.56   
1        4.00           0.0                    0.3         20.80   
2        1.45           0.0                    0.3          8.75   
3        6.39           0.0                    0.3         27.69   
5        2.06           0.0                    0.3         12.36   

   mean\PYGZus{}duration  mean\PYGZus{}distance  predicted\PYGZus{}fare  tip\PYGZus{}percent  generous  \PYGZbs{}
0      22.847222       3.521667       16.434245        0.200         1   
1      24.470370       3.108889       16.052218        0.238         1   
2       7.250000       0.881429        7.053706        0.199         0   
3      30.250000       3.700000       18.731650        0.300         1   
5      11.855376       2.052258       10.441351        0.200         1   

        day  am\PYGZus{}rush  daytime  pm\PYGZus{}rush  nighttime month  
0  saturday        1        0        0          0   mar  
1   tuesday        0        1        0          0   apr  
2    friday        1        0        0          0   dec  
3    sunday        0        1        0          0   may  
5  saturday        0        0        0          1   mar  
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Drop columns}
\label{\detokenize{Automatidata_Machine Learning:drop-columns}}
\sphinxAtStartPar
Drop redundant and irrelevant columns as well as those that would not be available when the model is deployed. This includes information like payment type, trip distance, tip amount, tip percentage, total amount, toll amount, etc. The target variable (\sphinxcode{\sphinxupquote{generous}}) must remain in the data because it will get isolated as the \sphinxcode{\sphinxupquote{y}} data for modeling.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
Index: 15265 entries, 0 to 22698
Data columns (total 29 columns):
 \PYGZsh{}   Column                 Non\PYGZhy{}Null Count  Dtype         
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}                 \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}         
 0   Unnamed: 0             15265 non\PYGZhy{}null  int64         
 1   VendorID               15265 non\PYGZhy{}null  int64         
 2   tpep\PYGZus{}pickup\PYGZus{}datetime   15265 non\PYGZhy{}null  datetime64[ns]
 3   tpep\PYGZus{}dropoff\PYGZus{}datetime  15265 non\PYGZhy{}null  datetime64[ns]
 4   passenger\PYGZus{}count        15265 non\PYGZhy{}null  int64         
 5   trip\PYGZus{}distance          15265 non\PYGZhy{}null  float64       
 6   RatecodeID             15265 non\PYGZhy{}null  int64         
 7   store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag     15265 non\PYGZhy{}null  object        
 8   PULocationID           15265 non\PYGZhy{}null  int64         
 9   DOLocationID           15265 non\PYGZhy{}null  int64         
 10  payment\PYGZus{}type           15265 non\PYGZhy{}null  int64         
 11  fare\PYGZus{}amount            15265 non\PYGZhy{}null  float64       
 12  extra                  15265 non\PYGZhy{}null  float64       
 13  mta\PYGZus{}tax                15265 non\PYGZhy{}null  float64       
 14  tip\PYGZus{}amount             15265 non\PYGZhy{}null  float64       
 15  tolls\PYGZus{}amount           15265 non\PYGZhy{}null  float64       
 16  improvement\PYGZus{}surcharge  15265 non\PYGZhy{}null  float64       
 17  total\PYGZus{}amount           15265 non\PYGZhy{}null  float64       
 18  mean\PYGZus{}duration          15265 non\PYGZhy{}null  float64       
 19  mean\PYGZus{}distance          15265 non\PYGZhy{}null  float64       
 20  predicted\PYGZus{}fare         15265 non\PYGZhy{}null  float64       
 21  tip\PYGZus{}percent            15262 non\PYGZhy{}null  float64       
 22  generous               15265 non\PYGZhy{}null  int64         
 23  day                    15265 non\PYGZhy{}null  object        
 24  am\PYGZus{}rush                15265 non\PYGZhy{}null  int64         
 25  daytime                15265 non\PYGZhy{}null  int64         
 26  pm\PYGZus{}rush                15265 non\PYGZhy{}null  int64         
 27  nighttime              15265 non\PYGZhy{}null  int64         
 28  month                  15265 non\PYGZhy{}null  object        
dtypes: datetime64[ns](2), float64(12), int64(12), object(3)
memory usage: 3.5+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Drop columns}
\PYG{n}{drop\PYGZus{}cols} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unnamed: 0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}pickup\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tpep\PYGZus{}dropoff\PYGZus{}datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{trip\PYGZus{}distance}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}and\PYGZus{}fwd\PYGZus{}flag}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{payment\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fare\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{extra}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mta\PYGZus{}tax}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tolls\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{improvement\PYGZus{}surcharge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}amount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tip\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{df1} \PYG{o}{=} \PYG{n}{df1}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{n}{drop\PYGZus{}cols}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{df1}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
Index: 15265 entries, 0 to 22698
Data columns (total 15 columns):
 \PYGZsh{}   Column           Non\PYGZhy{}Null Count  Dtype  
\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}           \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}  
 0   VendorID         15265 non\PYGZhy{}null  int64  
 1   passenger\PYGZus{}count  15265 non\PYGZhy{}null  int64  
 2   RatecodeID       15265 non\PYGZhy{}null  int64  
 3   PULocationID     15265 non\PYGZhy{}null  int64  
 4   DOLocationID     15265 non\PYGZhy{}null  int64  
 5   mean\PYGZus{}duration    15265 non\PYGZhy{}null  float64
 6   mean\PYGZus{}distance    15265 non\PYGZhy{}null  float64
 7   predicted\PYGZus{}fare   15265 non\PYGZhy{}null  float64
 8   generous         15265 non\PYGZhy{}null  int64  
 9   day              15265 non\PYGZhy{}null  object 
 10  am\PYGZus{}rush          15265 non\PYGZhy{}null  int64  
 11  daytime          15265 non\PYGZhy{}null  int64  
 12  pm\PYGZus{}rush          15265 non\PYGZhy{}null  int64  
 13  nighttime        15265 non\PYGZhy{}null  int64  
 14  month            15265 non\PYGZhy{}null  object 
dtypes: float64(3), int64(10), object(2)
memory usage: 1.9+ MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Variable encoding}
\label{\detokenize{Automatidata_Machine Learning:variable-encoding}}
\sphinxAtStartPar
Many of the columns are categorical and will need to be dummied (converted to binary). Some of these columns are numeric, but they actually encode categorical information, such as \sphinxcode{\sphinxupquote{RatecodeID}} and the pickup and dropoff locations. To make these columns recognizable to the \sphinxcode{\sphinxupquote{get\_dummies()}} function as categorical variables, you’ll first need to convert them to \sphinxcode{\sphinxupquote{type(str)}}.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Define a variable called \sphinxcode{\sphinxupquote{cols\_to\_str}}, which is a list of the numeric columns that contain categorical information and must be converted to string: \sphinxcode{\sphinxupquote{RatecodeID}}, \sphinxcode{\sphinxupquote{PULocationID}}, \sphinxcode{\sphinxupquote{DOLocationID}}.

\item {} 
\sphinxAtStartPar
Write a for loop that converts each column in \sphinxcode{\sphinxupquote{cols\_to\_str}} to string.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Define list of cols to convert to string}
\PYG{n}{cols\PYGZus{}to\PYGZus{}str} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RatecodeID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PULocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOLocationID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{VendorID}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} 2. Convert each column to string}
\PYG{k}{for} \PYG{n}{col} \PYG{o+ow}{in} \PYG{n}{cols\PYGZus{}to\PYGZus{}str}\PYG{p}{:}
    \PYG{n}{df1}\PYG{p}{[}\PYG{n}{col}\PYG{p}{]} \PYG{o}{=} \PYG{n}{df1}\PYG{p}{[}\PYG{n}{col}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{str}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now convert all the categorical columns to binary.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Call \sphinxcode{\sphinxupquote{get\_dummies()}} on the dataframe and assign the results back to a new dataframe called \sphinxcode{\sphinxupquote{df2}}.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Convert categoricals to binary}
\PYG{n}{df2} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{get\PYGZus{}dummies}\PYG{p}{(}\PYG{n}{df1}\PYG{p}{,} \PYG{n}{drop\PYGZus{}first}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{df2}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZlt{}class \PYGZsq{}pandas.core.frame.DataFrame\PYGZsq{}\PYGZgt{}
Index: 15265 entries, 0 to 22698
Columns: 347 entries, passenger\PYGZus{}count to month\PYGZus{}sep
dtypes: bool(338), float64(3), int64(6)
memory usage: 6.1 MB
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsubsection{Evaluation metric}
\label{\detokenize{Automatidata_Machine Learning:evaluation-metric}}
\sphinxAtStartPar
Before modeling, you must decide on an evaluation metric.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Examine the class balance of your target variable.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get class balance of \PYGZsq{}generous\PYGZsq{} col}
\PYG{n}{df2}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{value\PYGZus{}counts}\PYG{p}{(}\PYG{n}{normalize}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
generous
1    0.526368
0    0.473632
Name: proportion, dtype: float64
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
A little over half of the customers in this dataset were “generous” (tipped ≥ 20\%). The dataset is very nearly balanced.

\sphinxAtStartPar
To determine a metric, consider the cost of both kinds of model error:
\begin{itemize}
\item {} 
\sphinxAtStartPar
False positives (the model predicts a tip ≥ 20\%, but the customer does not give one)

\item {} 
\sphinxAtStartPar
False negatives (the model predicts a tip \textless{} 20\%, but the customer gives more)

\end{itemize}

\sphinxAtStartPar
False positives are worse for cab drivers, because they would pick up a customer expecting a good tip and then not receive one, frustrating the driver.

\sphinxAtStartPar
False negatives are worse for customers, because a cab driver would likely pick up a different customer who was predicted to tip more—even when the original customer would have tipped generously.

\sphinxAtStartPar
\sphinxstylestrong{The stakes are relatively even. You want to help taxi drivers make more money, but you don’t want this to anger customers. Your metric should weigh both precision and recall equally. Which metric is this?}

\sphinxAtStartPar
F1 score is the metric that places equal weight on true postives and false positives, and so therefore on precision and recall.


\section{Modeling}
\label{\detokenize{Automatidata_Machine Learning:modeling}}

\subsection{\sphinxstylestrong{Split the data}}
\label{\detokenize{Automatidata_Machine Learning:split-the-data}}
\sphinxAtStartPar
Now you’re ready to model. The only remaining step is to split the data into features/target variable and training/testing data.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Define a variable \sphinxcode{\sphinxupquote{y}} that isolates the target variable (\sphinxcode{\sphinxupquote{generous}}).

\item {} 
\sphinxAtStartPar
Define a variable \sphinxcode{\sphinxupquote{X}} that isolates the features.

\item {} 
\sphinxAtStartPar
Split the data into training and testing sets. Put 20\% of the samples into the test set, stratify the data, and set the random state.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Isolate target variable (y)}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{df2}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Isolate the features (X)}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{df2}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{generous}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Split into train and test sets}
\PYG{n}{X\PYGZus{}train}\PYG{p}{,} \PYG{n}{X\PYGZus{}test}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{,} \PYG{n}{y\PYGZus{}test} \PYG{o}{=} \PYG{n}{train\PYGZus{}test\PYGZus{}split}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{stratify}\PYG{o}{=}\PYG{n}{y}\PYG{p}{,} \PYG{n}{test\PYGZus{}size}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{\sphinxstylestrong{Random forest}}
\label{\detokenize{Automatidata_Machine Learning:random-forest}}
\sphinxAtStartPar
Begin with using \sphinxcode{\sphinxupquote{GridSearchCV}} to tune a random forest model.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Instantiate the random forest classifier \sphinxcode{\sphinxupquote{rf}} and set the random state.

\item {} 
\sphinxAtStartPar
Create a dictionary \sphinxcode{\sphinxupquote{cv\_params}} of any of the following hyperparameters and their corresponding values to tune. The more you tune, the better your model will fit the data, but the longer it will take.

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{max\_depth}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{max\_features}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{max\_samples}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{min\_samples\_leaf}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{min\_samples\_split}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{n\_estimators}}

\end{itemize}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Define a set \sphinxcode{\sphinxupquote{scoring}} of scoring metrics for GridSearch to capture (precision, recall, F1 score, and accuracy).

\item {} 
\sphinxAtStartPar
Instantiate the \sphinxcode{\sphinxupquote{GridSearchCV}} object \sphinxcode{\sphinxupquote{rf1}}. Pass to it as arguments:

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
estimator=\sphinxcode{\sphinxupquote{rf}}

\item {} 
\sphinxAtStartPar
param\_grid=\sphinxcode{\sphinxupquote{cv\_params}}

\item {} 
\sphinxAtStartPar
scoring=\sphinxcode{\sphinxupquote{scoring}}

\item {} 
\sphinxAtStartPar
cv: define the number of you cross\sphinxhyphen{}validation folds you want (\sphinxcode{\sphinxupquote{cv=\_}})

\item {} 
\sphinxAtStartPar
refit: indicate which evaluation metric you want to use to select the model (\sphinxcode{\sphinxupquote{refit=\_}})

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Note:} \sphinxcode{\sphinxupquote{refit}} should be set to \sphinxcode{\sphinxupquote{\textquotesingle{}f1\textquotesingle{}}}.



\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Instantiate the random forest classifier}
\PYG{n}{rf} \PYG{o}{=} \PYG{n}{RandomForestClassifier}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2. Create a dictionary of hyperparameters to tune }
\PYG{c+c1}{\PYGZsh{} Note that this example only contains 1 value for each parameter for simplicity,}
\PYG{c+c1}{\PYGZsh{} but you should assign a dictionary with ranges of values}
\PYG{n}{cv\PYGZus{}params} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}features}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}samples}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.7}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min\PYGZus{}samples\PYGZus{}leaf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min\PYGZus{}samples\PYGZus{}split}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}estimators}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{300}\PYG{p}{]}
             \PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} 3. Define a set of scoring metrics to capture}
\PYG{n}{scoring} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} 4. Instantiate the GridSearchCV object}
\PYG{n}{rf1} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{rf}\PYG{p}{,} \PYG{n}{cv\PYGZus{}params}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{n}{scoring}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{refit}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now fit the model to the training data.

\sphinxAtStartPar
\sphinxstylestrong{\sphinxstyleemphasis{Note}}: \sphinxstyleemphasis{Depending on how many options you include in your search grid and the number of cross\sphinxhyphen{}validation folds you select, this could take a very long time—even hours. If you use 4\sphinxhyphen{}fold validation and include only one possible value for each hyperparameter and grow 300 trees to full depth, it should take about 5 minutes. If you add another value for GridSearch to check for, say, \sphinxcode{\sphinxupquote{min\_samples\_split}} (so all hyperparameters now have 1 value except for \sphinxcode{\sphinxupquote{min\_samples\_split}}, which has 2 possibilities), it would double the time to \textasciitilde{}10 minutes. Each additional parameter would approximately double the time.}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}\PYGZpc{}time}
\PYG{n}{rf1}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train} \PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gt}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{n+ne}{KeyboardInterrupt}\PYG{g+gWhitespace}{                         }Traceback (most recent call last)
\PYG{n}{File} \PYG{o}{\PYGZlt{}}\PYG{n}{timed} \PYG{n+nb}{eval}\PYG{o}{\PYGZgt{}}\PYG{p}{:}\PYG{l+m+mi}{1}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/base.py:1473,} in \PYG{n+ni}{\PYGZus{}fit\PYGZus{}context.\PYGZlt{}locals\PYGZgt{}.decorator.\PYGZlt{}locals\PYGZgt{}.wrapper}\PYG{n+nt}{(estimator, *args, **kwargs)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1466}     \PYG{n}{estimator}\PYG{o}{.}\PYG{n}{\PYGZus{}validate\PYGZus{}params}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1468} \PYG{k}{with} \PYG{n}{config\PYGZus{}context}\PYG{p}{(}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1469}     \PYG{n}{skip\PYGZus{}parameter\PYGZus{}validation}\PYG{o}{=}\PYG{p}{(}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1470}         \PYG{n}{prefer\PYGZus{}skip\PYGZus{}nested\PYGZus{}validation} \PYG{o+ow}{or} \PYG{n}{global\PYGZus{}skip\PYGZus{}validation}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1471}     \PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1472} \PYG{p}{)}\PYG{p}{:}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1473}     \PYG{k}{return} \PYG{n}{fit\PYGZus{}method}\PYG{p}{(}\PYG{n}{estimator}\PYG{p}{,} \PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/model\PYGZus{}selection/\PYGZus{}search.py:1018,} in \PYG{n+ni}{BaseSearchCV.fit}\PYG{n+nt}{(self, X, y, **params)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1012}     \PYG{n}{results} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}format\PYGZus{}results}\PYG{p}{(}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1013}         \PYG{n}{all\PYGZus{}candidate\PYGZus{}params}\PYG{p}{,} \PYG{n}{n\PYGZus{}splits}\PYG{p}{,} \PYG{n}{all\PYGZus{}out}\PYG{p}{,} \PYG{n}{all\PYGZus{}more\PYGZus{}results}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1014}     \PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1016}     \PYG{k}{return} \PYG{n}{results}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1018} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}run\PYGZus{}search}\PYG{p}{(}\PYG{n}{evaluate\PYGZus{}candidates}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1020} \PYG{c+c1}{\PYGZsh{} multimetric is determined here because in the case of a callable}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1021} \PYG{c+c1}{\PYGZsh{} self.scoring the return type is only known after calling}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1022} \PYG{n}{first\PYGZus{}test\PYGZus{}score} \PYG{o}{=} \PYG{n}{all\PYGZus{}out}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{test\PYGZus{}scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/model\PYGZus{}selection/\PYGZus{}search.py:1572,} in \PYG{n+ni}{GridSearchCV.\PYGZus{}run\PYGZus{}search}\PYG{n+nt}{(self, evaluate\PYGZus{}candidates)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1570} \PYG{k}{def} \PYG{n+nf}{\PYGZus{}run\PYGZus{}search}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{evaluate\PYGZus{}candidates}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1571}\PYG{+w}{     }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Search all candidates in param\PYGZus{}grid\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1572}     \PYG{n}{evaluate\PYGZus{}candidates}\PYG{p}{(}\PYG{n}{ParameterGrid}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{param\PYGZus{}grid}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/model\PYGZus{}selection/\PYGZus{}search.py:964,} in \PYG{n+ni}{BaseSearchCV.fit.\PYGZlt{}locals\PYGZgt{}.evaluate\PYGZus{}candidates}\PYG{n+nt}{(candidate\PYGZus{}params, cv, more\PYGZus{}results)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{956} \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{verbose} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{957}     \PYG{n+nb}{print}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{958}         \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Fitting }\PYG{l+s+si}{\PYGZob{}0\PYGZcb{}}\PYG{l+s+s2}{ folds for each of }\PYG{l+s+si}{\PYGZob{}1\PYGZcb{}}\PYG{l+s+s2}{ candidates,}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{959}         \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ totalling }\PYG{l+s+si}{\PYGZob{}2\PYGZcb{}}\PYG{l+s+s2}{ fits}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{960}             \PYG{n}{n\PYGZus{}splits}\PYG{p}{,} \PYG{n}{n\PYGZus{}candidates}\PYG{p}{,} \PYG{n}{n\PYGZus{}candidates} \PYG{o}{*} \PYG{n}{n\PYGZus{}splits}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{961}         \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{962}     \PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{964} \PYG{n}{out} \PYG{o}{=} \PYG{n}{parallel}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{965}     \PYG{n}{delayed}\PYG{p}{(}\PYG{n}{\PYGZus{}fit\PYGZus{}and\PYGZus{}score}\PYG{p}{)}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{966}         \PYG{n}{clone}\PYG{p}{(}\PYG{n}{base\PYGZus{}estimator}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{967}         \PYG{n}{X}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{968}         \PYG{n}{y}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{969}         \PYG{n}{train}\PYG{o}{=}\PYG{n}{train}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{970}         \PYG{n}{test}\PYG{o}{=}\PYG{n}{test}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{971}         \PYG{n}{parameters}\PYG{o}{=}\PYG{n}{parameters}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{972}         \PYG{n}{split\PYGZus{}progress}\PYG{o}{=}\PYG{p}{(}\PYG{n}{split\PYGZus{}idx}\PYG{p}{,} \PYG{n}{n\PYGZus{}splits}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{973}         \PYG{n}{candidate\PYGZus{}progress}\PYG{o}{=}\PYG{p}{(}\PYG{n}{cand\PYGZus{}idx}\PYG{p}{,} \PYG{n}{n\PYGZus{}candidates}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{974}         \PYG{o}{*}\PYG{o}{*}\PYG{n}{fit\PYGZus{}and\PYGZus{}score\PYGZus{}kwargs}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{975}     \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{976}     \PYG{k}{for} \PYG{p}{(}\PYG{n}{cand\PYGZus{}idx}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{n}{split\PYGZus{}idx}\PYG{p}{,} \PYG{p}{(}\PYG{n}{train}\PYG{p}{,} \PYG{n}{test}\PYG{p}{)}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n}{product}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{977}         \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{candidate\PYGZus{}params}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{978}         \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{cv}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{routed\PYGZus{}params}\PYG{o}{.}\PYG{n}{splitter}\PYG{o}{.}\PYG{n}{split}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{979}     \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{980} \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{982} \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{out}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{1}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{983}     \PYG{k}{raise} \PYG{n+ne}{ValueError}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{984}         \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{No fits were performed. }\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{985}         \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Was the CV iterator empty? }\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{986}         \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Were there no candidates?}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{987}     \PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/utils/parallel.py:74,} in \PYG{n+ni}{Parallel.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{69} \PYG{n}{config} \PYG{o}{=} \PYG{n}{get\PYGZus{}config}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{70} \PYG{n}{iterable\PYGZus{}with\PYGZus{}config} \PYG{o}{=} \PYG{p}{(}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{71}     \PYG{p}{(}\PYG{n}{\PYGZus{}with\PYGZus{}config}\PYG{p}{(}\PYG{n}{delayed\PYGZus{}func}\PYG{p}{,} \PYG{n}{config}\PYG{p}{)}\PYG{p}{,} \PYG{n}{args}\PYG{p}{,} \PYG{n}{kwargs}\PYG{p}{)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{72}     \PYG{k}{for} \PYG{n}{delayed\PYGZus{}func}\PYG{p}{,} \PYG{n}{args}\PYG{p}{,} \PYG{n}{kwargs} \PYG{o+ow}{in} \PYG{n}{iterable}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{73} \PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{74} \PYG{k}{return} \PYG{n+nb}{super}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n}{iterable\PYGZus{}with\PYGZus{}config}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/joblib/parallel.py:1918,} in \PYG{n+ni}{Parallel.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1916}     \PYG{n}{output} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}get\PYGZus{}sequential\PYGZus{}output}\PYG{p}{(}\PYG{n}{iterable}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1917}     \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1918}     \PYG{k}{return} \PYG{n}{output} \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{return\PYGZus{}generator} \PYG{k}{else} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1920} \PYG{c+c1}{\PYGZsh{} Let\PYGZsq{}s create an ID that uniquely identifies the current call. If the}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1921} \PYG{c+c1}{\PYGZsh{} call is interrupted early and that the same instance is immediately}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1922} \PYG{c+c1}{\PYGZsh{} re\PYGZhy{}used, this id will be used to prevent workers that were}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1923} \PYG{c+c1}{\PYGZsh{} concurrently finalizing a task from the previous call to run the}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1924} \PYG{c+c1}{\PYGZsh{} callback.}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1925} \PYG{k}{with} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}lock}\PYG{p}{:}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/joblib/parallel.py:1847,} in \PYG{n+ni}{Parallel.\PYGZus{}get\PYGZus{}sequential\PYGZus{}output}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1845} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}dispatched\PYGZus{}batches} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1846} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}dispatched\PYGZus{}tasks} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1847} \PYG{n}{res} \PYG{o}{=} \PYG{n}{func}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1848} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}completed\PYGZus{}tasks} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1849} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{print\PYGZus{}progress}\PYG{p}{(}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/utils/parallel.py:136,} in \PYG{n+ni}{\PYGZus{}FuncWrapper.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, *args, **kwargs)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{134}     \PYG{n}{config} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{135} \PYG{k}{with} \PYG{n}{config\PYGZus{}context}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{config}\PYG{p}{)}\PYG{p}{:}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{136}     \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{function}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/model\PYGZus{}selection/\PYGZus{}validation.py:888,} in \PYG{n+ni}{\PYGZus{}fit\PYGZus{}and\PYGZus{}score}\PYG{n+nt}{(estimator, X, y, scorer, train, test, verbose, parameters, fit\PYGZus{}params, score\PYGZus{}params, return\PYGZus{}train\PYGZus{}score, return\PYGZus{}parameters, return\PYGZus{}n\PYGZus{}test\PYGZus{}samples, return\PYGZus{}times, return\PYGZus{}estimator, split\PYGZus{}progress, candidate\PYGZus{}progress, error\PYGZus{}score)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{886}         \PYG{n}{estimator}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{fit\PYGZus{}params}\PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{887}     \PYG{k}{else}\PYG{p}{:}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{888}         \PYG{n}{estimator}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{fit\PYGZus{}params}\PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{890} \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{891}     \PYG{c+c1}{\PYGZsh{} Note fit time as time until error}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{892}     \PYG{n}{fit\PYGZus{}time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{start\PYGZus{}time}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/base.py:1473,} in \PYG{n+ni}{\PYGZus{}fit\PYGZus{}context.\PYGZlt{}locals\PYGZgt{}.decorator.\PYGZlt{}locals\PYGZgt{}.wrapper}\PYG{n+nt}{(estimator, *args, **kwargs)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1466}     \PYG{n}{estimator}\PYG{o}{.}\PYG{n}{\PYGZus{}validate\PYGZus{}params}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1468} \PYG{k}{with} \PYG{n}{config\PYGZus{}context}\PYG{p}{(}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1469}     \PYG{n}{skip\PYGZus{}parameter\PYGZus{}validation}\PYG{o}{=}\PYG{p}{(}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1470}         \PYG{n}{prefer\PYGZus{}skip\PYGZus{}nested\PYGZus{}validation} \PYG{o+ow}{or} \PYG{n}{global\PYGZus{}skip\PYGZus{}validation}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1471}     \PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1472} \PYG{p}{)}\PYG{p}{:}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1473}     \PYG{k}{return} \PYG{n}{fit\PYGZus{}method}\PYG{p}{(}\PYG{n}{estimator}\PYG{p}{,} \PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/ensemble/\PYGZus{}forest.py:489,} in \PYG{n+ni}{BaseForest.fit}\PYG{n+nt}{(self, X, y, sample\PYGZus{}weight)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{478} \PYG{n}{trees} \PYG{o}{=} \PYG{p}{[}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{479}     \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}make\PYGZus{}estimator}\PYG{p}{(}\PYG{n}{append}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{n}{random\PYGZus{}state}\PYG{p}{)}
\PYG{n+nn}{    480     for i} in \PYG{n+ni}{range}\PYG{n+nt}{(n\PYGZus{}more\PYGZus{}estimators)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{481} \PYG{p}{]}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{483} \PYG{c+c1}{\PYGZsh{} Parallel loop: we prefer the threading backend as the Cython code}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{484} \PYG{c+c1}{\PYGZsh{} for fitting the trees is internally releasing the Python GIL}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{485} \PYG{c+c1}{\PYGZsh{} making threading more efficient than multiprocessing in}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{486} \PYG{c+c1}{\PYGZsh{} that case. However, for joblib 0.12+ we respect any}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{487} \PYG{c+c1}{\PYGZsh{} parallel\PYGZus{}backend contexts set at a higher level,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{488} \PYG{c+c1}{\PYGZsh{} since correctness does not rely on using threads.}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{489} \PYG{n}{trees} \PYG{o}{=} \PYG{n}{Parallel}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{490}     \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}jobs}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{491}     \PYG{n}{verbose}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{verbose}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{492}     \PYG{n}{prefer}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{threads}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{493} \PYG{p}{)}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{494}     \PYG{n}{delayed}\PYG{p}{(}\PYG{n}{\PYGZus{}parallel\PYGZus{}build\PYGZus{}trees}\PYG{p}{)}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{495}         \PYG{n}{t}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{496}         \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{bootstrap}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{497}         \PYG{n}{X}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{498}         \PYG{n}{y}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{499}         \PYG{n}{sample\PYGZus{}weight}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{500}         \PYG{n}{i}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{501}         \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{trees}\PYG{p}{)}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{502}         \PYG{n}{verbose}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{verbose}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{503}         \PYG{n}{class\PYGZus{}weight}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{class\PYGZus{}weight}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{504}         \PYG{n}{n\PYGZus{}samples\PYGZus{}bootstrap}\PYG{o}{=}\PYG{n}{n\PYGZus{}samples\PYGZus{}bootstrap}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{505}         \PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{o}{=}\PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{506}     \PYG{p}{)}
\PYG{n+nn}{    507     for i, t} in \PYG{n+ni}{enumerate}\PYG{n+nt}{(trees)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{508} \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{510} \PYG{c+c1}{\PYGZsh{} Collect newly grown trees}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{511} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{estimators\PYGZus{}}\PYG{o}{.}\PYG{n}{extend}\PYG{p}{(}\PYG{n}{trees}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/utils/parallel.py:74,} in \PYG{n+ni}{Parallel.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{69} \PYG{n}{config} \PYG{o}{=} \PYG{n}{get\PYGZus{}config}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{70} \PYG{n}{iterable\PYGZus{}with\PYGZus{}config} \PYG{o}{=} \PYG{p}{(}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{71}     \PYG{p}{(}\PYG{n}{\PYGZus{}with\PYGZus{}config}\PYG{p}{(}\PYG{n}{delayed\PYGZus{}func}\PYG{p}{,} \PYG{n}{config}\PYG{p}{)}\PYG{p}{,} \PYG{n}{args}\PYG{p}{,} \PYG{n}{kwargs}\PYG{p}{)}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{72}     \PYG{k}{for} \PYG{n}{delayed\PYGZus{}func}\PYG{p}{,} \PYG{n}{args}\PYG{p}{,} \PYG{n}{kwargs} \PYG{o+ow}{in} \PYG{n}{iterable}
\PYG{g+gWhitespace}{     }\PYG{l+m+mi}{73} \PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{74} \PYG{k}{return} \PYG{n+nb}{super}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n}{iterable\PYGZus{}with\PYGZus{}config}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/joblib/parallel.py:1918,} in \PYG{n+ni}{Parallel.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1916}     \PYG{n}{output} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}get\PYGZus{}sequential\PYGZus{}output}\PYG{p}{(}\PYG{n}{iterable}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1917}     \PYG{n+nb}{next}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1918}     \PYG{k}{return} \PYG{n}{output} \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{return\PYGZus{}generator} \PYG{k}{else} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1920} \PYG{c+c1}{\PYGZsh{} Let\PYGZsq{}s create an ID that uniquely identifies the current call. If the}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1921} \PYG{c+c1}{\PYGZsh{} call is interrupted early and that the same instance is immediately}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1922} \PYG{c+c1}{\PYGZsh{} re\PYGZhy{}used, this id will be used to prevent workers that were}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1923} \PYG{c+c1}{\PYGZsh{} concurrently finalizing a task from the previous call to run the}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1924} \PYG{c+c1}{\PYGZsh{} callback.}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1925} \PYG{k}{with} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{\PYGZus{}lock}\PYG{p}{:}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/joblib/parallel.py:1847,} in \PYG{n+ni}{Parallel.\PYGZus{}get\PYGZus{}sequential\PYGZus{}output}\PYG{n+nt}{(self, iterable)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1845} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}dispatched\PYGZus{}batches} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1846} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}dispatched\PYGZus{}tasks} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n+ne}{\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{1847} \PYG{n}{res} \PYG{o}{=} \PYG{n}{func}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1848} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}completed\PYGZus{}tasks} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{g+gWhitespace}{   }\PYG{l+m+mi}{1849} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{print\PYGZus{}progress}\PYG{p}{(}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/utils/parallel.py:136,} in \PYG{n+ni}{\PYGZus{}FuncWrapper.\PYGZus{}\PYGZus{}call\PYGZus{}\PYGZus{}}\PYG{n+nt}{(self, *args, **kwargs)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{134}     \PYG{n}{config} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{135} \PYG{k}{with} \PYG{n}{config\PYGZus{}context}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{config}\PYG{p}{)}\PYG{p}{:}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{136}     \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{function}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/ensemble/\PYGZus{}forest.py:192,} in \PYG{n+ni}{\PYGZus{}parallel\PYGZus{}build\PYGZus{}trees}\PYG{n+nt}{(tree, bootstrap, X, y, sample\PYGZus{}weight, tree\PYGZus{}idx, n\PYGZus{}trees, verbose, class\PYGZus{}weight, n\PYGZus{}samples\PYGZus{}bootstrap, missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{189}     \PYG{k}{elif} \PYG{n}{class\PYGZus{}weight} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{balanced\PYGZus{}subsample}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{190}         \PYG{n}{curr\PYGZus{}sample\PYGZus{}weight} \PYG{o}{*}\PYG{o}{=} \PYG{n}{compute\PYGZus{}sample\PYGZus{}weight}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{balanced}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{indices}\PYG{o}{=}\PYG{n}{indices}\PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{192}     \PYG{n}{tree}\PYG{o}{.}\PYG{n}{\PYGZus{}fit}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{193}         \PYG{n}{X}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{194}         \PYG{n}{y}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{195}         \PYG{n}{sample\PYGZus{}weight}\PYG{o}{=}\PYG{n}{curr\PYGZus{}sample\PYGZus{}weight}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{196}         \PYG{n}{check\PYGZus{}input}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{197}         \PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{o}{=}\PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{198}     \PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{199} \PYG{k}{else}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{200}     \PYG{n}{tree}\PYG{o}{.}\PYG{n}{\PYGZus{}fit}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{201}         \PYG{n}{X}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{202}         \PYG{n}{y}\PYG{p}{,}
   \PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{205}         \PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{o}{=}\PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{206}     \PYG{p}{)}

\PYG{n+nn}{File /opt/anaconda3/envs/General/lib/python3.12/site\PYGZhy{}packages/sklearn/tree/\PYGZus{}classes.py:472,} in \PYG{n+ni}{BaseDecisionTree.\PYGZus{}fit}\PYG{n+nt}{(self, X, y, sample\PYGZus{}weight, check\PYGZus{}input, missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{461} \PYG{k}{else}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{462}     \PYG{n}{builder} \PYG{o}{=} \PYG{n}{BestFirstTreeBuilder}\PYG{p}{(}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{463}         \PYG{n}{splitter}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{464}         \PYG{n}{min\PYGZus{}samples\PYGZus{}split}\PYG{p}{,}
   \PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{469}         \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{min\PYGZus{}impurity\PYGZus{}decrease}\PYG{p}{,}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{470}     \PYG{p}{)}
\PYG{n+ne}{\PYGZhy{}\PYGZhy{}\PYGZgt{} }\PYG{l+m+mi}{472} \PYG{n}{builder}\PYG{o}{.}\PYG{n}{build}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{tree\PYGZus{}}\PYG{p}{,} \PYG{n}{X}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{sample\PYGZus{}weight}\PYG{p}{,} \PYG{n}{missing\PYGZus{}values\PYGZus{}in\PYGZus{}feature\PYGZus{}mask}\PYG{p}{)}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{474} \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}outputs\PYGZus{}} \PYG{o}{==} \PYG{l+m+mi}{1} \PYG{o+ow}{and} \PYG{n}{is\PYGZus{}classifier}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gWhitespace}{    }\PYG{l+m+mi}{475}     \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}classes\PYGZus{}} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{n\PYGZus{}classes\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}

\PYG{n+ne}{KeyboardInterrupt}: 
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pickle} 

\PYG{c+c1}{\PYGZsh{} Define a path to the folder where you want to save the model}
\PYG{n}{path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home/jovyan/work/}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{write\PYGZus{}pickle}\PYG{p}{(}\PYG{n}{path}\PYG{p}{,} \PYG{n}{model\PYGZus{}object}\PYG{p}{,} \PYG{n}{save\PYGZus{}name}\PYG{p}{:}\PYG{n+nb}{str}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{    save\PYGZus{}name is a string.}
\PYG{l+s+sd}{    \PYGZsq{}\PYGZsq{}\PYGZsq{}}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{path} \PYG{o}{+} \PYG{n}{save\PYGZus{}name} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.pickle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{to\PYGZus{}write}\PYG{p}{:}
        \PYG{n}{pickle}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{model\PYGZus{}object}\PYG{p}{,} \PYG{n}{to\PYGZus{}write}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{read\PYGZus{}pickle}\PYG{p}{(}\PYG{n}{path}\PYG{p}{,} \PYG{n}{saved\PYGZus{}model\PYGZus{}name}\PYG{p}{:}\PYG{n+nb}{str}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{    saved\PYGZus{}model\PYGZus{}name is a string.}
\PYG{l+s+sd}{    \PYGZsq{}\PYGZsq{}\PYGZsq{}}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{path} \PYG{o}{+} \PYG{n}{saved\PYGZus{}model\PYGZus{}name} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.pickle}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{to\PYGZus{}read}\PYG{p}{:}
        \PYG{n}{model} \PYG{o}{=} \PYG{n}{pickle}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{to\PYGZus{}read}\PYG{p}{)}

        \PYG{k}{return} \PYG{n}{model}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Examine the best average score across all the validation folds.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Examine best score}
\PYG{n}{rf1}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0.7133701077670043
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Examine the best combination of hyperparameters.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rf1}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}max\PYGZus{}depth\PYGZsq{}: None,
 \PYGZsq{}max\PYGZus{}features\PYGZsq{}: 1.0,
 \PYGZsq{}max\PYGZus{}samples\PYGZsq{}: 0.7,
 \PYGZsq{}min\PYGZus{}samples\PYGZus{}leaf\PYGZsq{}: 1,
 \PYGZsq{}min\PYGZus{}samples\PYGZus{}split\PYGZsq{}: 2,
 \PYGZsq{}n\PYGZus{}estimators\PYGZsq{}: 300\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Use the \sphinxcode{\sphinxupquote{make\_results()}} function to output all of the scores of your model. Note that it accepts three arguments.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}results}\PYG{p}{(}\PYG{n}{model\PYGZus{}name}\PYG{p}{:}\PYG{n+nb}{str}\PYG{p}{,} \PYG{n}{model\PYGZus{}object}\PYG{p}{,} \PYG{n}{metric}\PYG{p}{:}\PYG{n+nb}{str}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{    Arguments:}
\PYG{l+s+sd}{    model\PYGZus{}name (string): what you want the model to be called in the output table}
\PYG{l+s+sd}{    model\PYGZus{}object: a fit GridSearchCV object}
\PYG{l+s+sd}{    metric (string): precision, recall, f1, or accuracy}

\PYG{l+s+sd}{    Returns a pandas df with the F1, recall, precision, and accuracy scores}
\PYG{l+s+sd}{    for the model with the best mean \PYGZsq{}metric\PYGZsq{} score across all validation folds.}
\PYG{l+s+sd}{    \PYGZsq{}\PYGZsq{}\PYGZsq{}}

    \PYG{c+c1}{\PYGZsh{} Create dictionary that maps input metric to actual metric name in GridSearchCV}
    \PYG{n}{metric\PYGZus{}dict} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}test\PYGZus{}precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}test\PYGZus{}recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}test\PYGZus{}f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean\PYGZus{}test\PYGZus{}accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                 \PYG{p}{\PYGZcb{}}

    \PYG{c+c1}{\PYGZsh{} Get all the results from the CV and put them in a df}
    \PYG{n}{cv\PYGZus{}results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{model\PYGZus{}object}\PYG{o}{.}\PYG{n}{cv\PYGZus{}results\PYGZus{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Isolate the row of the df with the max(metric) score}
    \PYG{n}{best\PYGZus{}estimator\PYGZus{}results} \PYG{o}{=} \PYG{n}{cv\PYGZus{}results}\PYG{o}{.}\PYG{n}{iloc}\PYG{p}{[}\PYG{n}{cv\PYGZus{}results}\PYG{p}{[}\PYG{n}{metric\PYGZus{}dict}\PYG{p}{[}\PYG{n}{metric}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{idxmax}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}

    \PYG{c+c1}{\PYGZsh{} Extract Accuracy, precision, recall, and f1 score from that row}
    \PYG{n}{f1} \PYG{o}{=} \PYG{n}{best\PYGZus{}estimator\PYGZus{}results}\PYG{o}{.}\PYG{n}{mean\PYGZus{}test\PYGZus{}f1}
    \PYG{n}{recall} \PYG{o}{=} \PYG{n}{best\PYGZus{}estimator\PYGZus{}results}\PYG{o}{.}\PYG{n}{mean\PYGZus{}test\PYGZus{}recall}
    \PYG{n}{precision} \PYG{o}{=} \PYG{n}{best\PYGZus{}estimator\PYGZus{}results}\PYG{o}{.}\PYG{n}{mean\PYGZus{}test\PYGZus{}precision}
    \PYG{n}{accuracy} \PYG{o}{=} \PYG{n}{best\PYGZus{}estimator\PYGZus{}results}\PYG{o}{.}\PYG{n}{mean\PYGZus{}test\PYGZus{}accuracy}

    \PYG{c+c1}{\PYGZsh{} Create table of results}
    \PYG{n}{table} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{model\PYGZus{}name}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{precision}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{recall}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{f1}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{accuracy}\PYG{p}{]}\PYG{p}{,}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{,}
                       \PYG{p}{)}

    \PYG{k}{return} \PYG{n}{table}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Call \PYGZsq{}make\PYGZus{}results()\PYGZsq{} on the GridSearch object}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{make\PYGZus{}results}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RF CV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{rf1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{results}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
   model  precision    recall       F1  accuracy
0  RF CV   0.675349  0.756223  0.71337  0.680314
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
This is an acceptable model across the board. Typically scores of 0.65 or better are considered acceptable, but this is always dependent on your use case. Optional: try to improve the scores. It’s worth trying, especially to practice searching over different hyperparameters.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get scores on test data}
\PYG{n}{rf\PYGZus{}preds} \PYG{o}{=} \PYG{n}{rf1}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X\PYGZus{}test}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Use the below \sphinxcode{\sphinxupquote{get\_test\_scores()}} function you will use to output the scores of the model on the test data.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{get\PYGZus{}test\PYGZus{}scores}\PYG{p}{(}\PYG{n}{model\PYGZus{}name}\PYG{p}{:}\PYG{n+nb}{str}\PYG{p}{,} \PYG{n}{preds}\PYG{p}{,} \PYG{n}{y\PYGZus{}test\PYGZus{}data}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{l+s+sd}{    Generate a table of test scores.}

\PYG{l+s+sd}{    In:}
\PYG{l+s+sd}{    model\PYGZus{}name (string): Your choice: how the model will be named in the output table}
\PYG{l+s+sd}{    preds: numpy array of test predictions}
\PYG{l+s+sd}{    y\PYGZus{}test\PYGZus{}data: numpy array of y\PYGZus{}test data}

\PYG{l+s+sd}{    Out:}
\PYG{l+s+sd}{    table: a pandas df of precision, recall, f1, and accuracy scores for your model}
\PYG{l+s+sd}{    \PYGZsq{}\PYGZsq{}\PYGZsq{}}
    \PYG{n}{accuracy} \PYG{o}{=} \PYG{n}{metrics}\PYG{o}{.}\PYG{n}{accuracy\PYGZus{}score}\PYG{p}{(}\PYG{n}{y\PYGZus{}test\PYGZus{}data}\PYG{p}{,} \PYG{n}{preds}\PYG{p}{)}
    \PYG{n}{precision} \PYG{o}{=} \PYG{n}{metrics}\PYG{o}{.}\PYG{n}{precision\PYGZus{}score}\PYG{p}{(}\PYG{n}{y\PYGZus{}test\PYGZus{}data}\PYG{p}{,} \PYG{n}{preds}\PYG{p}{)}
    \PYG{n}{recall} \PYG{o}{=} \PYG{n}{metrics}\PYG{o}{.}\PYG{n}{recall\PYGZus{}score}\PYG{p}{(}\PYG{n}{y\PYGZus{}test\PYGZus{}data}\PYG{p}{,} \PYG{n}{preds}\PYG{p}{)}
    \PYG{n}{f1} \PYG{o}{=} \PYG{n}{metrics}\PYG{o}{.}\PYG{n}{f1\PYGZus{}score}\PYG{p}{(}\PYG{n}{y\PYGZus{}test\PYGZus{}data}\PYG{p}{,} \PYG{n}{preds}\PYG{p}{)}

    \PYG{n}{table} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{model\PYGZus{}name}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{precision}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{recall}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{f1}\PYG{p}{]}\PYG{p}{,}
                        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{n}{accuracy}\PYG{p}{]}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}

    \PYG{k}{return} \PYG{n}{table}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Use the \sphinxcode{\sphinxupquote{get\_test\_scores()}} function to generate the scores on the test data. Assign the results to \sphinxcode{\sphinxupquote{rf\_test\_scores}}.

\item {} 
\sphinxAtStartPar
Call \sphinxcode{\sphinxupquote{rf\_test\_scores}} to output the results.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get scores on test data}
\PYG{n}{rf\PYGZus{}test\PYGZus{}scores} \PYG{o}{=} \PYG{n}{get\PYGZus{}test\PYGZus{}scores}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RF test}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{rf\PYGZus{}preds}\PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{p}{[}\PYG{n}{results}\PYG{p}{,} \PYG{n}{rf\PYGZus{}test\PYGZus{}scores}\PYG{p}{]}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{results}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
     model  precision    recall        F1  accuracy
0    RF CV   0.675349  0.756223  0.713370  0.680314
0  RF test   0.674419  0.775980  0.721644  0.684900
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{\sphinxstylestrong{XGBoost}}
\label{\detokenize{Automatidata_Machine Learning:xgboost}}
\sphinxAtStartPar
Try to improve your scores using an XGBoost model.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Instantiate the XGBoost classifier \sphinxcode{\sphinxupquote{xgb}} and set \sphinxcode{\sphinxupquote{objective=\textquotesingle{}binary:logistic\textquotesingle{}}}. Also set the random state.

\item {} 
\sphinxAtStartPar
Create a dictionary \sphinxcode{\sphinxupquote{cv\_params}} of the following hyperparameters and their corresponding values to tune:

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{max\_depth}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{min\_child\_weight}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{learning\_rate}}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{n\_estimators}}

\end{itemize}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Define a set \sphinxcode{\sphinxupquote{scoring}} of scoring metrics for grid search to capture (precision, recall, F1 score, and accuracy).

\item {} 
\sphinxAtStartPar
Instantiate the \sphinxcode{\sphinxupquote{GridSearchCV}} object \sphinxcode{\sphinxupquote{xgb1}}. Pass to it as arguments:

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
estimator=\sphinxcode{\sphinxupquote{xgb}}

\item {} 
\sphinxAtStartPar
param\_grid=\sphinxcode{\sphinxupquote{cv\_params}}

\item {} 
\sphinxAtStartPar
scoring=\sphinxcode{\sphinxupquote{scoring}}

\item {} 
\sphinxAtStartPar
cv: define the number of cross\sphinxhyphen{}validation folds you want (\sphinxcode{\sphinxupquote{cv=\_}})

\item {} 
\sphinxAtStartPar
refit: indicate which evaluation metric you want to use to select the model (\sphinxcode{\sphinxupquote{refit=\textquotesingle{}f1\textquotesingle{}}})

\end{itemize}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Instantiate the XGBoost classifier}
\PYG{n}{xgb} \PYG{o}{=} \PYG{n}{XGBClassifier}\PYG{p}{(}\PYG{n}{objective}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary:logistic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} 2. Create a dictionary of hyperparameters to tune}
\PYG{c+c1}{\PYGZsh{} Note that this example only contains 1 value for each parameter for simplicity,}
\PYG{c+c1}{\PYGZsh{} but you should assign a dictionary with ranges of values}
\PYG{n}{cv\PYGZus{}params} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{learning\PYGZus{}rate}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min\PYGZus{}child\PYGZus{}weight}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}estimators}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{500}\PYG{p}{]}
             \PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} 3. Define a set of scoring metrics to capture}
\PYG{n}{scoring} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{precision}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recall}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} 4. Instantiate the GridSearchCV object}
\PYG{n}{xgb1} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{xgb}\PYG{p}{,} \PYG{n}{cv\PYGZus{}params}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{n}{scoring}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{refit}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now fit the model to the \sphinxcode{\sphinxupquote{X\_train}} and \sphinxcode{\sphinxupquote{y\_train}} data.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}\PYGZpc{}time}
\PYG{n}{xgb1}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X\PYGZus{}train}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
CPU times: user 25.3 s, sys: 8.48 s, total: 33.8 s
Wall time: 16.2 s
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=4,
             estimator=XGBClassifier(base\PYGZus{}score=None, booster=None,
                                     callbacks=None, colsample\PYGZus{}bylevel=None,
                                     colsample\PYGZus{}bynode=None,
                                     colsample\PYGZus{}bytree=None, device=None,
                                     early\PYGZus{}stopping\PYGZus{}rounds=None,
                                     enable\PYGZus{}categorical=False, eval\PYGZus{}metric=None,
                                     feature\PYGZus{}types=None, gamma=None,
                                     grow\PYGZus{}policy=None, importance\PYGZus{}type=None,
                                     interaction\PYGZus{}constraints=None,
                                     learning\PYGZus{}rate=None,...
                                     max\PYGZus{}delta\PYGZus{}step=None, max\PYGZus{}depth=None,
                                     max\PYGZus{}leaves=None, min\PYGZus{}child\PYGZus{}weight=None,
                                     missing=nan, monotone\PYGZus{}constraints=None,
                                     multi\PYGZus{}strategy=None, n\PYGZus{}estimators=None,
                                     n\PYGZus{}jobs=None, num\PYGZus{}parallel\PYGZus{}tree=None,
                                     random\PYGZus{}state=0, ...),
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}learning\PYGZus{}rate\PYGZsq{}: [0.1], \PYGZsq{}max\PYGZus{}depth\PYGZsq{}: [8],
                         \PYGZsq{}min\PYGZus{}child\PYGZus{}weight\PYGZsq{}: [2], \PYGZsq{}n\PYGZus{}estimators\PYGZsq{}: [500]\PYGZcb{},
             refit=\PYGZsq{}f1\PYGZsq{}, scoring=[\PYGZsq{}accuracy\PYGZsq{}, \PYGZsq{}precision\PYGZsq{}, \PYGZsq{}recall\PYGZsq{}, \PYGZsq{}f1\PYGZsq{}])
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Examine best score}
\PYG{n}{xgb1}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
0.6955124635485909
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Examine best parameters}
\PYG{n}{xgb1}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZob{}\PYGZsq{}learning\PYGZus{}rate\PYGZsq{}: 0.1,
 \PYGZsq{}max\PYGZus{}depth\PYGZsq{}: 8,
 \PYGZsq{}min\PYGZus{}child\PYGZus{}weight\PYGZsq{}: 2,
 \PYGZsq{}n\PYGZus{}estimators\PYGZsq{}: 500\PYGZcb{}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Call \PYGZsq{}make\PYGZus{}results()\PYGZsq{} on the GridSearch object}
\PYG{n}{xgb1\PYGZus{}cv\PYGZus{}results} \PYG{o}{=} \PYG{n}{make\PYGZus{}results}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{XGB CV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{xgb1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{p}{[}\PYG{n}{results}\PYG{p}{,} \PYG{n}{xgb1\PYGZus{}cv\PYGZus{}results}\PYG{p}{]}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{results}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
     model  precision    recall        F1  accuracy
0    RF CV   0.675349  0.756223  0.713370  0.680314
0  RF test   0.674419  0.775980  0.721644  0.684900
0   XGB CV   0.669726  0.723553  0.695512  0.666557
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Use your model to predict on the test data. Assign the results to a variable called \sphinxcode{\sphinxupquote{xgb\_preds}}.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get scores on test data}
\PYG{n}{xgb\PYGZus{}preds} \PYG{o}{=} \PYG{n}{xgb1}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X\PYGZus{}test}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Use the \sphinxcode{\sphinxupquote{get\_test\_scores()}} function to generate the scores on the test data. Assign the results to \sphinxcode{\sphinxupquote{xgb\_test\_scores}}.

\item {} 
\sphinxAtStartPar
Call \sphinxcode{\sphinxupquote{xgb\_test\_scores}} to output the results.

\end{enumerate}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get scores on test data}
\PYG{n}{xgb\PYGZus{}test\PYGZus{}scores} \PYG{o}{=} \PYG{n}{get\PYGZus{}test\PYGZus{}scores}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{XGB test}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{xgb\PYGZus{}preds}\PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)}
\PYG{n}{results} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{p}{[}\PYG{n}{results}\PYG{p}{,} \PYG{n}{xgb\PYGZus{}test\PYGZus{}scores}\PYG{p}{]}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{results}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
      model  precision    recall        F1  accuracy
0     RF CV   0.675349  0.756223  0.713370  0.680314
0   RF test   0.674419  0.775980  0.721644  0.684900
0    XGB CV   0.669726  0.723553  0.695512  0.666557
0  XGB test   0.677219  0.745488  0.709716  0.679004
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Plot a confusion matrix of the champion model’s predictions on the test data.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{metrics} \PYG{k+kn}{import} \PYG{n}{confusion\PYGZus{}matrix}\PYG{p}{,} \PYG{n}{ConfusionMatrixDisplay}\PYG{p}{,} \PYG{n}{RocCurveDisplay}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Generate array of values for confusion matrix}
\PYG{n}{cm} \PYG{o}{=} \PYG{n}{confusion\PYGZus{}matrix}\PYG{p}{(}\PYG{n}{y\PYGZus{}test}\PYG{p}{,} \PYG{n}{rf\PYGZus{}preds}\PYG{p}{,} \PYG{n}{labels}\PYG{o}{=}\PYG{n}{rf1}\PYG{o}{.}\PYG{n}{classes\PYGZus{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot confusion matrix}
\PYG{n}{disp} \PYG{o}{=} \PYG{n}{ConfusionMatrixDisplay}\PYG{p}{(}\PYG{n}{confusion\PYGZus{}matrix}\PYG{o}{=}\PYG{n}{cm}\PYG{p}{,}
                             \PYG{n}{display\PYGZus{}labels}\PYG{o}{=}\PYG{n}{rf1}\PYG{o}{.}\PYG{n}{classes\PYGZus{}}\PYG{p}{,} 
                             \PYG{p}{)}
\PYG{n}{disp}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{values\PYGZus{}format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{ded3e1ed7b728f6292bd304ba6ffe8c09248c7b991bcaa5dcc30420c543aaef4}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Use the \sphinxcode{\sphinxupquote{feature\_importances\_}} attribute of the best estimator object to inspect the features of your final model. You can then sort them and plot the most important ones.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{importances} \PYG{o}{=} \PYG{n}{rf1}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{o}{.}\PYG{n}{feature\PYGZus{}importances\PYGZus{}}
\PYG{n}{rf\PYGZus{}importances} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{Series}\PYG{p}{(}\PYG{n}{importances}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{n}{X\PYGZus{}test}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}
\PYG{n}{rf\PYGZus{}importances} \PYG{o}{=} \PYG{n}{rf\PYGZus{}importances}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{15}\PYG{p}{]}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{rf\PYGZus{}importances}\PYG{o}{.}\PYG{n}{plot}\PYG{o}{.}\PYG{n}{bar}\PYG{p}{(}\PYG{n}{ax}\PYG{o}{=}\PYG{n}{ax}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Feature importances}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mean decrease in impurity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{2fb50d6ff348b8fbeadc90ad2343ffff8cc72d0988338b2b0bb5e18a8d18f7b3}.png}

\end{sphinxuseclass}
\end{sphinxuseclass}






\renewcommand{\indexname}{Index}
\printindex
\end{document}